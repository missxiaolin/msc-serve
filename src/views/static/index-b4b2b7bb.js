import{t as e,a}from"./index-cd0c75ff.js";import{r as t}from"./service-0e365184.js";import{u as l}from"./usePagination-f5a0e47d.js";import{g as n,i as r,R as s,Q as i,K as o,_ as u,r as d,o as p,a as c,k as g,l as m,b as h,F as f,A as _,y,z as D,d as C,e as v}from"./index-affe7dad.js";const b={class:"app-container"},T={class:"custom-main-contents visit-left-contents visit-right-contents",ref:"mainRef"},S={class:"flex-1 flex flex-column"},R={class:"pager-wrapper mt20"},x={class:"visit-right-contents"},I={class:"basic-header"};const E=u({setup(){let u=n({height:500,searchData:{uuId:"",categorys:["PAGE_CHANGE","USER_CLICK","HTTP_LOG","JS_ERROR"],data:e({format:["00:00:00","23:59:59"]})},categoryOptions:[{value:"PAGE_CHANGE",label:"用户浏览"},{value:"USER_CLICK",label:"用户点击"},{value:"HTTP_LOG",label:"用户请求"},{value:"JS_ERROR",label:"JS错误"}],pageDetail:{},userList:[]});const{paginationData:d,handleCurrentChange:p,handleSizeChange:c}=l((()=>{g()})),g=async()=>{if(!u.searchData.uuId||!u.searchData.categorys)return void o(u.searchData.uuId?"请选择事件类型":"请输入用户ID");let e={uuId:u.searchData.uuId,categorys:u.searchData.categorys,startTime:u.searchData.data[0],endTime:u.searchData.data[1],page:d.currentPage,pageSize:d.pageSize},a=await function(e){return t({url:"/adm/get/user/behavior",method:"post",data:e})}(e);a.success?(u.pageDetail=a.model.pageDetail||{},u.userList=a.model.userList||[],d.total=a.model.count):u.pageDetail={}},m=async()=>{d.currentPage=1,d.pageSize=10,g()},h=r(null);return s((()=>{i((()=>{u.height=h.value.offsetHeight-100})),m()})),{data:u,init:m,resetSearch:()=>{},paginationData:d,handleCurrentChange:p,handleSizeChange:c,timeformatter:a,mainRef:h}}},[["render",function(e,a,t,l,n,r){const s=d("el-input"),i=d("el-form-item"),o=d("el-option"),u=d("el-select"),E=d("el-date-picker"),P=d("el-button"),k=d("el-form"),z=d("el-card"),L=d("el-timeline-item"),G=d("el-timeline"),A=d("el-scrollbar"),H=d("el-pagination"),U=d("el-col"),O=d("el-row");return p(),c("div",b,[g(z,{class:"search-wrapper"},{default:m((()=>[g(k,{ref:"searchFormRef",inline:!0,model:l.data.searchData},{default:m((()=>[g(i,{prop:"uuId",label:"用户Id"},{default:m((()=>[g(s,{modelValue:l.data.searchData.uuId,"onUpdate:modelValue":a[0]||(a[0]=e=>l.data.searchData.uuId=e),placeholder:"请输入用户ID"},null,8,["modelValue"])])),_:1}),g(i,{prop:"categorys",label:"事件类型"},{default:m((()=>[g(u,{modelValue:l.data.searchData.categorys,"onUpdate:modelValue":a[1]||(a[1]=e=>l.data.searchData.categorys=e),multiple:"",placeholder:"请选择事件类型",style:{width:"400px"}},{default:m((()=>[(p(!0),c(f,null,_(l.data.categoryOptions,(e=>(p(),C(o,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),g(i,{prop:"phone",label:"日期"},{default:m((()=>[g(E,{modelValue:l.data.searchData.data,"onUpdate:modelValue":a[2]||(a[2]=e=>l.data.searchData.data=e),type:"datetimerange","range-separator":"-","start-placeholder":"开始时间","end-placeholder":"结束时间"},null,8,["modelValue"])])),_:1}),g(i,null,{default:m((()=>[g(P,{type:"primary",onClick:l.init},{default:m((()=>[y("查询")])),_:1},8,["onClick"]),g(P,{onClick:l.resetSearch},{default:m((()=>[y("重置")])),_:1},8,["onClick"])])),_:1})])),_:1},8,["model"])])),_:1}),h("section",T,[g(z,{class:"flex flex-1 flex-column visit-left-list"},{default:m((()=>[h("div",S,[g(A,{"max-height":`${l.data.height}px`,style:{flex:"1"}},{default:m((()=>[g(G,null,{default:m((()=>[(p(!0),c(f,null,_(l.data.userList,((e,a)=>(p(),C(L,{icon:"USER_CLICK"==e.category?"Pointer":"HTTP_LOG"==e.category?"Position":"PAGE_CHANGE"==e.category?"Files":"JS_ERROR"==e.category?"CircleClose":"",center:"",timestamp:e.happenTime,placement:"top",key:a},{default:m((()=>[g(z,{style:{width:"95%"}},{default:m((()=>["USER_CLICK"==e.category?(p(),c(f,{key:0},[h("p",null,D(e.subType),1),h("p",null,"pageUrl: "+D(e.pageUrl),1),h("p",null,"tagName: "+D(e.tagName),1),h("p",null,"innerHTML: "+D(e.innerHTML),1)],64)):v("",!0),"HTTP_LOG"==e.category?(p(),c(f,{key:1},[h("p",null,D(e.subType)+"请求方式: "+D(e.method)+" 请求方式:"+D(e.type)+" 接口状态: "+D(e.status)+" 耗时:"+D(l.timeformatter(e.duration)),1),h("p",null,"pageUrl: "+D(e.pageUrl),1),h("p",null,"pathName: "+D(e.pathName),1),h("p",null,"requestText: "+D(e.requestText),1),h("p",null,"responseText: "+D(e.responseText),1)],64)):v("",!0),"PAGE_CHANGE"==e.category?(p(),c(f,{key:2},[h("p",null,D(e.subType)+" 停留:"+D(l.timeformatter(e.duration)),1),h("p",null,"referrer: "+D(e.referrer),1),h("p",null,"from: "+D(e.from),1),h("p",null,"to: "+D(e.to),1)],64)):v("",!0),"JS_ERROR"==e.category?(p(),c(f,{key:3},[h("p",null,D(e.subType),1),h("p",null,D(e.errorMsg),1)],64)):v("",!0)])),_:2},1024)])),_:2},1032,["icon","timestamp"])))),128))])),_:1})])),_:1},8,["max-height"]),h("div",R,[g(H,{background:"",layout:l.paginationData.layout,"page-sizes":l.paginationData.pageSizes,total:l.paginationData.total,"page-size":l.paginationData.pageSize,currentPage:l.paginationData.currentPage,onSizeChange:l.handleSizeChange,onCurrentChange:l.handleCurrentChange},null,8,["layout","page-sizes","total","page-size","currentPage","onSizeChange","onCurrentChange"])])])])),_:1}),h("div",x,[h("div",I,[g(O,null,{default:m((()=>[g(U,{span:12},{default:m((()=>[y("cip： "+D(l.data.pageDetail.ip),1)])),_:1}),g(U,{span:12},{default:m((()=>[y("cregion： "+D(l.data.pageDetail.country),1)])),_:1}),g(U,{span:12},{default:m((()=>[y("deviceType： "+D(l.data.pageDetail.deviceType),1)])),_:1}),g(U,{span:12},{default:m((()=>[y("os： "+D(l.data.pageDetail.os),1)])),_:1}),g(U,{span:12},{default:m((()=>[y("browserInfo： "+D(l.data.pageDetail.browserInfo),1)])),_:1}),g(U,{span:12},{default:m((()=>[y("device： "+D(l.data.pageDetail.device),1)])),_:1}),g(U,{span:12},{default:m((()=>[y("deviceModel： "+D(l.data.pageDetail.deviceModel),1)])),_:1}),g(U,{span:12},{default:m((()=>[y("language： "+D(l.data.pageDetail.language),1)])),_:1}),g(U,{span:12},{default:m((()=>[y("netWork： "+D(l.data.pageDetail.netWork),1)])),_:1}),g(U,{span:12}),g(U,{span:12},{default:m((()=>[y("userAgent： "+D(l.data.pageDetail.userAgent),1)])),_:1})])),_:1})])])],512)])}],["__scopeId","data-v-b0ea7196"]]);export{E as default};
