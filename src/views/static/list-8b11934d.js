var e=Object.defineProperty,a=Object.getOwnPropertySymbols,l=Object.prototype.hasOwnProperty,t=Object.prototype.propertyIsEnumerable,r=(a,l,t)=>l in a?e(a,l,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[l]=t,o=(e,o)=>{for(var s in o||(o={}))l.call(o,s)&&r(e,s,o[s]);if(a)for(var s of a(o))t.call(o,s)&&r(e,s,o[s]);return e},s=(e,a,l)=>new Promise(((t,r)=>{var o=e=>{try{n(l.next(e))}catch(a){r(a)}},s=e=>{try{n(l.throw(e))}catch(a){r(a)}},n=e=>e.done?t(e.value):Promise.resolve(e.value).then(o,s);n((l=l.apply(e,a)).next())}));import{E as n}from"./index-32eb9909.js";import{h as p,t as i}from"./index-dd9bb23f.js";import{i as u,w as c,_ as d,r as h,o as m,a as g,k as f,F as y,b,R as v,a8 as D,a9 as C,aa as T,ab as _,ac as S,ad as P,Q as w,ae as x,S as O,d as k,l as z,A as U,x as V,e as j}from"./index-da95a02c.js";import{D as R}from"./detailPopup-b137fa02.js";import{r as N}from"./service-81f5d47a.js";import{u as I}from"./usePagination-45f7e46f.js";const E={components:{Echarts:n},props:{echartsOptions:{type:Object,required:!0}},setup(e){const a=u({}),l=()=>{let{seriesData:l=[],axisData:t=[],seriesName:r={}}=e.echartsOptions;l=l.map(((e,a)=>o({},o({name:r[a],type:"bar",barGap:0,emphasis:{focus:"series"}},e)))),a.value={xAxis:{type:"category",data:t,axisLabel:{color:"#95979e",align:"center",formatter:(e,a)=>{const l=p(e).format("MM-DD HH:mm").split(" ");return`${l[0]}\n${l[1]}`}}},yAxis:{type:"value"},dataZoom:[{type:"inside"}],seriesColorReset:!0,series:[...l]}};return l(),c((()=>e.echartsOptions),(e=>{l()})),{options:a}}},M=b("div",{class:"flex"},null,-1);const H={class:"app-container"},L={class:"table-wrapper"},A={class:"pager-wrapper"};const G=d({name:"Resource",components:{ResHoursEchart:d(E,[["render",function(e,a,l,t,r,o){const s=h("Echarts");return m(),g(y,null,[M,f(s,{options:t.options},null,8,["options"])],64)}]]),DetailPopup:R},setup(){const e=u(!1),a=u({}),l=u([{value:"IMG",label:"IMG"},{value:"LINK",label:"LINK"},{value:"SCRIPT",label:"SCRIPT"}]),t=u({pageUrl:"",url:"",resourceType:"",data:i({format:["00:00:00","23:59:59"]})}),r=u({}),o=u([]),{paginationData:n,handleCurrentChange:p,handleSizeChange:c}=I((()=>{d()}));v((()=>{d(),h()}));const d=()=>s(this,null,(function*(){let e={url:t.value.url,pageUrl:t.value.pageUrl,resourceType:t.value.resourceType,startTime:t.value.data[0],endTime:t.value.data[1],page:n.currentPage,pageSize:n.pageSize},a=yield(l=e,N({url:"/adm/resource/list",method:"post",data:l}));var l;a.success&&(n.total=a.model.count,o.value=a.model.list)})),h=()=>s(this,null,(function*(){let e={startTime:t.value.data[0],endTime:t.value.data[1]},l=yield(r=e,N({url:"/adm/resource/hour",method:"post",data:r}));var r;l.success&&(a.value=l.model)}));return{resourceTypes:l,loading:e,searchData:t,resetSearch:()=>{t.value={pageUrl:"",url:"",resourceType:"",data:i({format:["00:00:00","23:59:59"]})},d(),h()},handleSearch:d,Search:D,Refresh:C,CirclePlus:T,RefreshRight:_,Delete:S,Download:P,tableData:o,paginationData:n,handleCurrentChange:p,handleSizeChange:c,handleDetail:e=>{r.value={},w((()=>r.value=e))},perfNode:r,init:()=>s(this,null,(function*(){d(),h()})),echartsOptions:a}}},[["render",function(e,a,l,t,r,o){const s=h("el-input"),n=h("el-form-item"),p=h("el-option"),i=h("el-select"),u=h("el-date-picker"),c=h("el-button"),d=h("el-form"),v=h("el-card"),D=h("ResHoursEchart"),C=h("el-table-column"),T=h("el-table"),_=h("el-pagination"),S=h("DetailPopup"),P=x("loading");return m(),g(y,null,[b("div",H,[O((m(),k(v,{shadow:"never",class:"search-wrapper"},{default:z((()=>[f(d,{ref:"searchFormRef",inline:!0,model:t.searchData},{default:z((()=>[f(n,{prop:"pageUrl",label:"页面链接"},{default:z((()=>[f(s,{modelValue:t.searchData.pageUrl,"onUpdate:modelValue":a[0]||(a[0]=e=>t.searchData.pageUrl=e),placeholder:"请输入"},null,8,["modelValue"])])),_:1}),f(n,{prop:"resourceType",label:"资源类型"},{default:z((()=>[f(i,{modelValue:t.searchData.resourceType,"onUpdate:modelValue":a[1]||(a[1]=e=>t.searchData.resourceType=e),placeholder:"请选择"},{default:z((()=>[(m(!0),g(y,null,U(t.resourceTypes,(e=>(m(),k(p,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),f(n,{prop:"url",label:"资源链接"},{default:z((()=>[f(s,{modelValue:t.searchData.url,"onUpdate:modelValue":a[2]||(a[2]=e=>t.searchData.url=e),placeholder:"请输入"},null,8,["modelValue"])])),_:1}),f(n,{prop:"phone",label:"日期"},{default:z((()=>[f(u,{modelValue:t.searchData.data,"onUpdate:modelValue":a[3]||(a[3]=e=>t.searchData.data=e),type:"datetimerange","range-separator":"-","start-placeholder":"开始时间","end-placeholder":"结束时间"},null,8,["modelValue"])])),_:1}),f(n,null,{default:z((()=>[f(c,{type:"primary",onClick:t.init},{default:z((()=>[V("查询")])),_:1},8,["onClick"]),f(c,{onClick:t.resetSearch},{default:z((()=>[V("重置")])),_:1},8,["onClick"])])),_:1})])),_:1},8,["model"])])),_:1})),[[P,t.loading]]),t.echartsOptions.seriesName?(m(),k(v,{key:0,shadow:"always",class:"mt20 mb20"},{default:z((()=>[f(D,{echartsOptions:t.echartsOptions},null,8,["echartsOptions"])])),_:1})):j("",!0),O((m(),k(v,{shadow:"never"},{default:z((()=>[b("div",L,[f(T,{border:"",data:t.tableData},{default:z((()=>[f(C,{prop:"resourceType",label:"错误类型",align:"center"}),f(C,{prop:"errorMsg",label:"错误信息",align:"center"}),f(C,{prop:"html",label:"HTML内容",align:"center"}),f(C,{prop:"pageUrl",label:"上报页面",align:"center"}),f(C,{prop:"happenTime",label:"上报时间",align:"center"}),f(C,{label:"操作",fixed:"right",align:"center"},{default:z((({row:e})=>[f(c,{type:"text",onClick:a=>t.handleDetail(e)},{default:z((()=>[V(" 查看详情 ")])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"])]),b("div",A,[f(_,{background:"",layout:t.paginationData.layout,"page-sizes":t.paginationData.pageSizes,total:t.paginationData.total,"page-size":t.paginationData.pageSize,currentPage:t.paginationData.currentPage,onSizeChange:t.handleSizeChange,onCurrentChange:t.handleCurrentChange},null,8,["layout","page-sizes","total","page-size","currentPage","onSizeChange","onCurrentChange"])])])),_:1})),[[P,t.loading]])]),t.perfNode.resourceType?(m(),k(S,{key:0,perfNode:t.perfNode},null,8,["perfNode"])):j("",!0)],64)}],["__scopeId","data-v-c81a3c6a"]]);export{G as default};
