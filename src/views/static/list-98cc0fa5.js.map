{"version":3,"file":"list-98cc0fa5.js","sources":["../../src/views/js/list.vue"],"sourcesContent":["<template>\n  <div class=\"app-container\">\n    <el-card shadow=\"never\" class=\"search-wrapper\">\n      <el-form ref=\"searchFormRef\" :inline=\"true\" :model=\"searchData\">\n        <el-form-item prop=\"pageUrl\" label=\"页面链接\">\n          <el-input v-model=\"searchData.pageUrl\" placeholder=\"请输入页面链接\" />\n        </el-form-item>\n        <el-form-item prop=\"simpleUrl\" label=\"页面链接\">\n          <el-input\n            v-model=\"searchData.simpleUrl\"\n            placeholder=\"请输入带*的页面链接\"\n          />\n        </el-form-item>\n        <el-form-item prop=\"url\" label=\"错误信息\">\n          <el-input v-model=\"searchData.errorMsg\" placeholder=\"请输入错误信息\" />\n        </el-form-item>\n        <el-form-item prop=\"phone\" label=\"日期\">\n          <el-date-picker\n            v-model=\"searchData.data\"\n            type=\"datetimerange\"\n            range-separator=\"-\"\n            start-placeholder=\"开始时间\"\n            end-placeholder=\"结束时间\"\n          />\n        </el-form-item>\n        <el-form-item>\n          <el-button type=\"primary\" @click=\"initQuery\">查询</el-button>\n          <el-button @click=\"resetSearch\">重置</el-button>\n        </el-form-item>\n      </el-form>\n    </el-card>\n    <!-- 图表 -->\n    <el-card shadow=\"never\">\n      <JsHoursEchart :params=\"searchData\"></JsHoursEchart>\n    </el-card>\n    <!-- 表格 -->\n    <el-card shadow=\"never\" class=\"mt20\">\n      <div class=\"table-wrapper\">\n        <el-table border :data=\"tableData\">\n          <el-table-column prop=\"type\" label=\"错误类型\" align=\"center\" />\n          <el-table-column prop=\"errorMsg\" label=\"错误内容\" align=\"center\" />\n          <el-table-column prop=\"simpleUrl\" label=\"上报页面\" align=\"center\" />\n          <el-table-column prop=\"happenTime\" label=\"上报时间\" align=\"center\" />\n          <el-table-column prop=\"uuId\" label=\"上报人\" align=\"center\" />\n          <el-table-column label=\"操作\" fixed=\"right\" align=\"center\">\n            <template #default=\"{ row }\">\n              <el-button type=\"text\" @click=\"handleDetail(row)\">\n                查看详情\n              </el-button>\n            </template>\n          </el-table-column>\n        </el-table>\n      </div>\n      <div class=\"pager-wrapper\">\n        <el-pagination\n          background\n          :layout=\"paginationData.layout\"\n          :page-sizes=\"paginationData.pageSizes\"\n          :total=\"paginationData.total\"\n          :page-size=\"paginationData.pageSize\"\n          :currentPage=\"paginationData.currentPage\"\n          @size-change=\"handleSizeChange\"\n          @current-change=\"handleCurrentChange\"\n        />\n      </div>\n    </el-card>\n    <DetailPopup v-if=\"perfNode.type\" :perfNode=\"perfNode\" />\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { onMounted, ref, nextTick } from \"vue\";\nimport JsHoursEchart from \"@/components/jsComponents/jsHoursEchart.vue\";\nimport { timeQuantum } from \"@/utils/index\";\nimport { jsList } from \"@/api/js/index\";\nimport { usePagination } from \"@/hooks/usePagination\";\nimport { JsListItem } from \"@/api/js/types\";\nimport DetailPopup from \"../../components/detailPopup.vue\";\nexport default {\n  components: {\n    JsHoursEchart,\n    DetailPopup,\n  },\n  setup() {\n    // 表格\n    const tableData = ref<JsListItem[]>([]);\n\n    const searchData = ref({\n      pageUrl: \"\",\n      simpleUrl: \"\",\n      errorMsg: \"\",\n      data: timeQuantum({ format: [\"00:00:00\", \"23:59:59\"] }),\n    });\n\n    const { paginationData, handleCurrentChange, handleSizeChange } =\n      usePagination(() => {\n        handleSearch();\n      });\n\n    // 表格\n    const handleSearch = async () => {\n      let param = {\n        pageUrl: searchData.value.pageUrl,\n        errorMsg: searchData.value.errorMsg,\n        startTime: searchData.value.data[0],\n        endTime: searchData.value.data[1],\n        page: paginationData.currentPage,\n        pageSize: paginationData.pageSize,\n      };\n      let res = await jsList(param);\n      if (!res.success) {\n        return;\n      }\n      paginationData.total = res.model.count;\n      tableData.value = res.model.list;\n    };\n\n    const initQuery = () => {\n      handleSearch();\n    };\n\n    // 重置\n    const resetSearch = () => {\n      searchData.value = {\n        pageUrl: \"\",\n        simpleUrl: \"\",\n        errorMsg: \"\",\n        data: timeQuantum({ format: [\"00:00:00\", \"23:59:59\"] }),\n      };\n      paginationData.currentPage = 1;\n    };\n\n    // js 错误详情\n    const perfNode: any = ref({});\n    /**\n     * @description: 查看性能详情\n     * @param {*} row\n     * @return {*}\n     */\n    const handleDetail = (row: any) => {\n      perfNode.value = {};\n      nextTick(() => (perfNode.value = row));\n    };\n\n    onMounted(() => {\n      initQuery();\n    });\n\n    return {\n      searchData,\n      paginationData,\n      handleCurrentChange,\n      handleSizeChange,\n      tableData,\n      resetSearch,\n      initQuery,\n      handleDetail,\n      perfNode,\n    };\n  },\n};\n</script>\n\n<style lang=\"scss\" scoped>\n.search-wrapper {\n  margin-bottom: 20px;\n  display: flex;\n  :deep(.el-card__body) {\n    padding-bottom: 2px;\n  }\n}\n\n.toolbar-wrapper {\n  display: flex;\n  justify-content: space-between;\n  margin-bottom: 20px;\n}\n\n.table-wrapper {\n  margin-bottom: 20px;\n}\n\n.pager-wrapper {\n  display: flex;\n  justify-content: flex-end;\n}\n</style>\n"],"names":["_hoisted_1","class","components","JsHoursEchart","DetailPopup","setup","tableData","ref","searchData","pageUrl","simpleUrl","errorMsg","data","timeQuantum","format","paginationData","handleCurrentChange","handleSizeChange","usePagination","handleSearch","async","param","value","startTime","endTime","page","currentPage","pageSize","res","jsList","success","total","model","count","list","initQuery","perfNode","onMounted","resetSearch","handleDetail","row","nextTick","_resolveComponent","_openBlock","_createElementBlock","_createVNode","_component_el_card","shadow","_withCtx","_component_el_form","inline","default","_component_el_form_item","prop","_component_el_input","modelValue","$setup","_cache","$event","_","_component_el_date_picker","type","_component_el_button","onClick","_createElementVNode","_hoisted_2","_component_el_table","border","_component_el_table_column","label","align","fixed","_hoisted_3","_component_el_pagination","background","layout","pageSizes","onSizeChange","_createBlock","_component_DetailPopup","key"],"mappings":"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"}