import{E as t}from"./index-7e38eb64.js";import{c as e,_ as a,r as s,o as r,a as i,b as o,k as n,l,F as p,y as c}from"./index-ec675762.js";import{r as d}from"./service-712b9305.js";const u={class:"flex flex-row justify-between",style:{width:"100%"}};const h=a({components:{Echarts:t},props:{options:{type:Object,required:!0}},name:"perfEchart",setup:t=>({ntFormat:e=>{let a=null==t?void 0:t.options;if(!a||!Object.keys(a).length)return 0;let s=a.NT[e]||0;if(!s&&0===s)return 0;const r=a.FP||{},i=a.FCP||{};return"FP"==e&&Object.keys(r).length&&(s=r.startTime),"FPC"==e&&Object.keys(i).length&&(s=i.startTime),Number((s||0).toFixed(2))},navigationEchart:e((()=>{var e;const a=(null==(e=t.options)?void 0:e.NT)||{};if(!a||!Object.keys(a).length)return{};const s=["DomReady","Res","DomParse","Trans","TTFB","SSL","TCP","DNS"],r=[],i=[];s.forEach(((t,e)=>{const o=(a[t]||0).toFixed(2);i.push(`${o}ms`);const n={name:t,type:"bar",stack:"Total",label:{show:!0,position:"right"},data:[]};for(let a=0,r=s.length;a<r;a++)e==a?n.data.push(o):n.data.push("-");r.push(n)}));const{DomParse:o=0,Res:n=0,Trans:l=0,TTFB:p=0,TCP:c=0,SSL:d=0,DNS:u=0}=a;return{tooltip:{trigger:"axis",axisPointer:{type:"shadow"},formatter:function(t){for(let e=1,a=t.length;e<a;e++){let{name:a,value:s,seriesName:r,color:i}=t[e];if("-"!==s)return`${a}</br><span style="display:flex; align-items: center;">\n\t\t\t\t\t<i style="display:block;margin-right:5px;border-radius:50%;width:10px;height:10px;left:5px;background-color:${i}"></i>${r}:\n\t\t\t\t\t<i style="padding-left: 30px;">${s}</i>\n\t\t\t\t</span>`}}},xAxis:{type:"value",show:!1,axisLine:{show:!1},axisTick:{show:!1},splitLine:{lineStyle:{type:"dotted"}}},yAxis:[{axisLine:{show:!1},axisTick:{show:!1},splitLine:{lineStyle:{type:"dotted"}},type:"category",data:["DOM准备","资源加载","DOM解析","内容传输","请求响应","SSL建连","TCP链接","DNS查询"]},{axisLine:{show:!1},axisTick:{show:!1},splitLine:{lineStyle:{type:"dotted"}},type:"category",data:i}],seriesColorReset:!1,series:[{name:"Placeholder",type:"bar",stack:"Total",silent:!0,itemStyle:{borderColor:"transparent",color:"transparent"},emphasis:{itemStyle:{borderColor:"transparent",color:"transparent"}},data:[`${n+o+p+c+d+u}`,`${o+p+c+d+u}`,`${l+p+c+d+u}`,`${p+c+d+u}`,`${c+d+u}`,`${c+u}`,`${u}`,`${u}`]},...r]}}))})},[["render",function(t,e,a,d,h,m){const y=s("el-statistic"),f=s("Echarts");return r(),i(p,null,[o("div",u,[n(y,{title:"白屏时间",value:d.ntFormat("FP")},{suffix:l((()=>[c("ms")])),_:1},8,["value"]),n(y,{title:"首字节",value:d.ntFormat("FirseByte")},{suffix:l((()=>[c("ms")])),_:1},8,["value"]),n(y,{title:"DOM Ready",value:d.ntFormat("DomReady")},{suffix:l((()=>[c("ms")])),_:1},8,["value"]),n(y,{title:"首次可交互时间",value:d.ntFormat("TTI")},{suffix:l((()=>[c("ms")])),_:1},8,["value"]),n(y,{title:"页面完全加载",value:d.ntFormat("Load")},{suffix:l((()=>[c("ms")])),_:1},8,["value"])]),n(f,{options:d.navigationEchart},null,8,["options"])],64)}]]),m={components:{Echarts:t},props:{options:{type:Object,required:!0}},name:"wxPerfEchart",setup:t=>({ntFormat:e=>{let a=null==t?void 0:t.options;if(!a||!Object.keys(a).length)return 0;let s=a.NT[e]||0;const r=a.FP||{},i=a.FCP||{},o=a.LCP||{},n=a.NT||{};return"FCP"==e&&i.startTime&&(s=i.startTime-n.appLaunchStartTime),"FP"==e&&Object.keys(r).length&&(s=r.startTime-n.appLaunchStartTime),"LCP"==e&&o.startTime&&(s=o.startTime-n.appLaunchStartTime),Number((s||0).toFixed(2))},navigationEchart:e((()=>{var e;const a=(null==(e=t.options)?void 0:e.NT)||{};if(!a||!Object.keys(a).length)return{};const s=["firstRender","script","route","appLaunch","loadPackage"],r=[],i=[];s.forEach(((t,e)=>{const o=(a[t]||0).toFixed(2);i.push(`${o}ms`);const n={name:t,type:"bar",stack:"Total",label:{show:!0,position:"right"},data:[]};for(let a=0,r=s.length;a<r;a++)e==a?n.data.push(o):n.data.push("-");r.push(n)}));const{script:o=0,route:n=0,loadPackage:l=0,appLaunch:p=0}=a;return{tooltip:{trigger:"axis",axisPointer:{type:"shadow"},formatter:function(t){for(let e=1,a=t.length;e<a;e++){let{name:a,value:s,seriesName:r,color:i}=t[e];if("-"!==s)return`${a}</br><span style="display:flex; align-items: center;">\n\t\t\t\t\t<i style="display:block;margin-right:5px;border-radius:50%;width:10px;height:10px;left:5px;background-color:${i}"></i>${r}:\n\t\t\t\t\t<i style="padding-left: 30px;">${s}</i>\n\t\t\t\t</span>`}}},xAxis:{type:"value",show:!1,axisLine:{show:!1},axisTick:{show:!1},splitLine:{lineStyle:{type:"dotted"}}},yAxis:[{axisLine:{show:!1},axisTick:{show:!1},splitLine:{lineStyle:{type:"dotted"}},type:"category",data:["页面渲染","JS注入","路由","小程序启动","代码包下载"]},{axisLine:{show:!1},axisTick:{show:!1},splitLine:{lineStyle:{type:"dotted"}},type:"category",data:i}],seriesColorReset:!1,series:[{name:"Placeholder",type:"bar",stack:"Total",silent:!0,itemStyle:{borderColor:"transparent",color:"transparent"},emphasis:{itemStyle:{borderColor:"transparent",color:"transparent"}},data:[`${p+l+n+o}`,`${p+l+n}`,`${p+l}`,`${l}`]},...r]}}))})},y=o("div",{class:"flex flex-row justify-between",style:{width:"100%"}},null,-1);const f=a(m,[["render",function(t,e,a,o,l,c){const d=s("Echarts");return r(),i(p,null,[y,n(d,{options:o.navigationEchart},null,8,["options"])],64)}]]);function x(t){return d({url:"/adm/performance/list",method:"post",data:t})}function g(t){return d({url:"/adm/performance/echart/by/url",method:"post",data:t})}export{h as P,f as W,g as a,x as p};
