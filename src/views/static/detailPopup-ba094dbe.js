import{s as e,a as l}from"./index-92682e75.js";import{m as n,r as a,S as r,p as s,o,a as t,k as i,_ as d,i as c,af as u,R as p,K as m,d as f,l as v,b as h,z as y,y as g,e as N,F as b,A as x,M as k,N as T}from"./index-a8789281.js";const E={mounted(e,l,n){let a=n.props.errorLine||0;n.props;let r=e.querySelector("code.hljs"),s=document.getElementsByTagName("pre")[0],o=(null==r?void 0:r.innerHTML).split("\n").length,t=document.createElement("ul");t.id="hljs-url";for(let c=1;c<=o;c++){let e=document.createElement("li");e.innerText=c+"",c==a&&0!=a&&(e.className="li-error-line",e.id="li-error-line"),t.appendChild(e)}t.classList.add("hljs-code-number"),e.insertBefore(t,s);let i=document.getElementById("li-error-line");document.getElementsByClassName("hljs-container")[0].scrollTop=i.offsetTop-50;let d=document.createElement("div");d.classList.add("hljs-copy"),d.innerText="复制",d.addEventListener("click",(()=>{let e=document.createElement("textarea");document.body.appendChild(e),e.setAttribute("readonly","readonly"),e.value=r.innerText,e.select(),document.execCommand("copy")&&(document.execCommand("copy"),d.innerText="复制成功"),document.body.removeChild(e)})),s.appendChild(d),e.addEventListener("mouseout",(()=>{d.innerText="复制",d.style.display="none"})),e.addEventListener("mouseover",(()=>{d.style.display="block"}))}},_=["errorLine"],C={components:{highlight:d(n({__name:"index",props:{htmlCode:{default:""},errorLine:{default:0}},setup(e){const l=e;return(e,n)=>{const d=a("highlightjs");return r((o(),t("div",{class:"hljs-container",codetype:"JavaScript",errorLine:l.errorLine},[i(d,{language:"JavaScript",autodetect:!1,code:l.htmlCode},null,8,["code"])],8,_)),[[s(E),l.errorLine]])}}}),[["__scopeId","data-v-1103b96b"]])},props:{perfNode:{type:Object,required:!0}},name:"",setup(n){const{perfNode:a}=n,r=c(!0);let s=u(a.stackTraces?JSON.parse(a.stackTraces):[]);const o=async e=>{let n={filename:e},a=await l(n);return a.success?a.model:[]};return p((()=>{(async()=>{if("JS_ERROR"==a.category&&s.value.length>0)for(let l=0;l<s.value.length;l++){let n=s.value[l].url;s.value[l].version="";const a=n.substring(n.lastIndexOf("/")+1).split("?")[0];s.value[l].filename=a;try{s.value[l].versions=await o(a+".map")}catch(e){s.value[l].versions=[]}}})()})),{drawerVisible:r,resetFile:e=>{if(!e)return"";let l=e.match(/\http(.+?)\.js/g);return l&&l.length?l[0]:""},stackTraces:s,mapAnalysis:async(l,n)=>{if(!l.version)return m({message:"请先选择版本",type:"warning"}),!1;const a={filename:l.filename+".map",version:l.version,line:l.lineno,column:l.colno};let r=await e(a);r.success?(r.model,s.value[n].code=r.model):m({message:r.errorMessage,type:"error"})}}}},R=e=>(k("data-v-b986caca"),e=e(),T(),e),j={class:"js-error-detail-content flex flex-1"},w={class:"flex-1 left-content"},L={class:"title flex"},V={class:"line1 flex"},S={class:"flex flex-1 align-items-center","data-user":"上报人"},I={class:"flex flex-1 align-items-center","data-user":"浏览器"},O={class:"flex flex-1 align-items-center","data-user":"系统"},z={class:"line2"},J={class:"flex flex-wrap"},A=R((()=>h("label",null,"ip:",-1))),U=R((()=>h("label",null,"区域:",-1))),M=R((()=>h("label",null,"设备:",-1))),P=R((()=>h("label",null,"设备尺寸:",-1))),B=R((()=>h("label",null,"浏览器:",-1))),F=R((()=>h("label",null,"地址页面:",-1))),D={class:"single-ellipsis"},q=R((()=>h("h2",{class:"title"},"UserAgent",-1))),H={class:"line3"},K={class:"title"},G={class:"line4"},Q={key:0},W={class:"title"},X={class:"line4"},Y={key:0,class:"ml5"},Z={key:1,class:"ml5"},$={key:0,codetype:"JavaScript",class:"mt20"},ee={key:0,class:"vue-replenish-info"},le=R((()=>h("h3",null,"其他补充信息：",-1)));const ne=d(C,[["render",function(e,l,n,r,s,d){const c=a("UserFilled"),u=a("el-icon"),p=a("ChromeFilled"),m=a("Iphone"),k=a("el-option"),T=a("el-select"),E=a("el-button"),_=a("highlight"),C=a("el-scroll"),R=a("el-drawer");return o(),f(R,{modelValue:r.drawerVisible,"onUpdate:modelValue":l[0]||(l[0]=e=>r.drawerVisible=e),ref:"drawerRef",title:"详情",direction:"rtl",size:"80%","append-to-body":!0,"z-index":2e3},{default:v((()=>[h("div",j,[i(C,{ref:"scrollbarRef",trigger:"hover",class:"flex-1",direction:"all"},{default:v((()=>{var e,l,a,s;return[h("div",w,[h("h2",L," 基本信息 (项目ID: "+y(n.perfNode.monitorAppId)+") ",1)]),h("div",V,[h("p",S,[i(u,{size:20},{default:v((()=>[i(c)])),_:1}),g(" "+y(n.perfNode.uuId),1)]),h("p",I,[i(u,{size:"20"},{default:v((()=>[i(p)])),_:1}),g(" "+y(n.perfNode.browserInfo),1)]),h("p",O,[i(u,{size:"20"},{default:v((()=>[i(m)])),_:1}),g(" "+y(n.perfNode.os),1)])]),h("div",null,[h("dl",z,[h("dd",J,[h("p",null,[A,h("label",null,y(n.perfNode.ip||""),1)]),h("p",null,[U,h("label",null,y(n.perfNode.country||""),1)]),h("p",null,[M,h("label",null,y(n.perfNode.device||""),1)]),h("p",null,[P,h("label",null,y(n.perfNode.deviceType||""),1)]),h("p",null,[B,h("label",null,y(n.perfNode.device||""),1)]),h("p",null,[F,h("label",D,y(n.perfNode.pageUrl),1)])])]),q,h("dl",H,[h("dd",null,y(n.perfNode.userAgent),1)]),"RESOURCE_ERROR"===n.perfNode.category?(o(),t(b,{key:0},[h("h2",K,"错误信息 ("+y(n.perfNode.happenTime)+")",1),h("dl",G,[h("dt",null,y(n.perfNode.category)+"： "+y(n.perfNode.errorMsg),1),h("dd",null,y(n.perfNode.html||""),1),n.perfNode.paths&&n.perfNode.paths.length?(o(),t("dd",Q," DOM Paths："+y(JSON.stringify(n.perfNode.paths)),1)):N("",!0)])],64)):N("",!0),"JS_ERROR"===n.perfNode.category?(o(),t(b,{key:1},[h("h2",W,y("vueError"==n.perfNode.subType?"Vue":"Js")+"错误堆栈 ("+y(n.perfNode.happenTime)+") ",1),h("dl",X,[h("dt",null,y(n.perfNode.type)+"： "+y(n.perfNode.errorMsg),1),(o(!0),t(b,null,x(r.stackTraces,((e,l)=>(o(),t("dd",{key:l},[h("div",null,[h("span",null,[g("at functionName: "+y(e.filename)+"（",1),h("cite",null,[g(":"),h("b",null,y(e.lineno||e.line),1),g(":"),h("b",null,y(e.colno||e.col),1)]),g("）")]),e.versions?(o(),t("span",Y,[i(T,{modelValue:r.stackTraces[l].version,"onUpdate:modelValue":e=>r.stackTraces[l].version=e,placeholder:"请选选择版本库",size:"small",style:{width:"130px"}},{default:v((()=>[(o(!0),t(b,null,x(e.versions,((e,l)=>(o(),f(k,{key:l,label:e.version,value:e.version},null,8,["label","value"])))),128))])),_:2},1032,["modelValue","onUpdate:modelValue"])])):N("",!0),e.versions?(o(),t("span",Z,[i(E,{size:"small",type:"primary",onClick:n=>r.mapAnalysis(e,l)},{default:v((()=>[g("解析")])),_:2},1032,["onClick"])])):N("",!0)]),e.code?(o(),t("div",$,[h("p",null,y(e.code.originalPosition.source)+": (line："+y(e.code.originalPosition.line)+" column："+y(e.code.originalPosition.column)+")",1),i(_,{htmlCode:e.code.sourcesContent,"error-line":e.code.originalPosition.line},null,8,["htmlCode","error-line"])])):N("",!0)])))),128))]),"vueError"==(null==(e=n.perfNode)?void 0:e.subType)?(o(),t("div",ee,[le,h("p",null,[g(" hook: "),h("b",null,y(null==(l=n.perfNode)?void 0:l.hook),1)]),h("p",null,[g(" componentName: "),h("b",null,y(null==(a=n.perfNode)?void 0:a.componentName),1)]),h("p",null,[g(" componentNameTrace: "),h("b",null,y(null==(s=n.perfNode)?void 0:s.componentNameTrace),1)])])):N("",!0)],64)):N("",!0)])]})),_:1},512)])])),_:1},8,["modelValue"])}],["__scopeId","data-v-b986caca"]]);export{ne as D};
//# sourceMappingURL=detailPopup-ba094dbe.js.map
