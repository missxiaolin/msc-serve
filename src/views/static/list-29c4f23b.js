import{E as e}from"./index-f508d0cf.js";import{h as a,t as l}from"./index-bdf07b24.js";import{h as t,w as r,_ as s,r as o,o as n,a as p,d as u,F as i,b as d,R as c,a8 as h,a9 as m,aa as g,ab as f,ac as y,ad as b,P as v,ae as D,S as C,k as T,j as _,x as S,A as x,y as z}from"./index-ff3f8bb3.js";import{D as k}from"./detailPopup-097241f9.js";import{r as w}from"./service-21cd3415.js";import{u as P}from"./usePagination-a31d1b37.js";const U={components:{Echarts:e},props:{echartsOptions:{type:Object,required:!0}},setup(e){const l=t({}),s=()=>{let{seriesData:t=[],axisData:r=[],seriesName:s={}}=e.echartsOptions;t=t.map(((e,a)=>({...{name:s[a],type:"bar",barGap:0,emphasis:{focus:"series"},...e}}))),l.value={xAxis:{type:"category",data:r,axisLabel:{color:"#95979e",align:"center",formatter:(e,l)=>{const t=a(e).format("MM-DD HH:mm").split(" ");return`${t[0]}\n${t[1]}`}}},yAxis:{type:"value"},dataZoom:[{type:"inside"}],seriesColorReset:!0,series:[...t]}};return s(),r((()=>e.echartsOptions),(e=>{s()})),{options:l}}},V=d("div",{class:"flex"},null,-1);const R={class:"app-container"},j={class:"table-wrapper"},N={class:"pager-wrapper"};const O=s({name:"Resource",components:{ResHoursEchart:s(U,[["render",function(e,a,l,t,r,s){const d=o("Echarts");return n(),p(i,null,[V,u(d,{options:t.options},null,8,["options"])],64)}]]),DetailPopup:k},setup(){const e=t(!1),a=t({}),r=t([{value:"IMG",label:"IMG"},{value:"LINK",label:"LINK"},{value:"SCRIPT",label:"SCRIPT"}]),s=t({pageUrl:"",url:"",resourceType:"",data:l({format:["00:00:00","23:59:59"]})}),o=t({}),n=t([]),{paginationData:p,handleCurrentChange:u,handleSizeChange:i}=P((()=>{d()}));c((()=>{d(),D()}));const d=async()=>{let e={url:s.value.url,pageUrl:s.value.pageUrl,resourceType:s.value.resourceType,startTime:s.value.data[0],endTime:s.value.data[1],page:p.currentPage,pageSize:p.pageSize},a=await(l=e,w({url:"/adm/resource/list",method:"post",data:l}));var l;a.success&&(p.total=a.model.count,n.value=a.model.list)},D=async()=>{let e={startTime:s.value.data[0],endTime:s.value.data[1]},l=await(t=e,w({url:"/adm/resource/hour",method:"post",data:t}));var t;l.success&&(a.value=l.model)};return{resourceTypes:r,loading:e,searchData:s,resetSearch:()=>{s.value={pageUrl:"",url:"",resourceType:"",data:l({format:["00:00:00","23:59:59"]})},d(),D()},handleSearch:d,Search:h,Refresh:m,CirclePlus:g,RefreshRight:f,Delete:y,Download:b,tableData:n,paginationData:p,handleCurrentChange:u,handleSizeChange:i,handleDetail:e=>{o.value={},v((()=>o.value=e))},perfNode:o,init:async()=>{d(),D()},echartsOptions:a}}},[["render",function(e,a,l,t,r,s){const c=o("el-input"),h=o("el-form-item"),m=o("el-option"),g=o("el-select"),f=o("el-date-picker"),y=o("el-button"),b=o("el-form"),v=o("el-card"),k=o("ResHoursEchart"),w=o("el-table-column"),P=o("el-table"),U=o("el-pagination"),V=o("DetailPopup"),O=D("loading");return n(),p(i,null,[d("div",R,[C((n(),T(v,{shadow:"never",class:"search-wrapper"},{default:_((()=>[u(b,{ref:"searchFormRef",inline:!0,model:t.searchData},{default:_((()=>[u(h,{prop:"pageUrl",label:"页面链接"},{default:_((()=>[u(c,{modelValue:t.searchData.pageUrl,"onUpdate:modelValue":a[0]||(a[0]=e=>t.searchData.pageUrl=e),placeholder:"请输入"},null,8,["modelValue"])])),_:1}),u(h,{prop:"resourceType",label:"资源类型"},{default:_((()=>[u(g,{modelValue:t.searchData.resourceType,"onUpdate:modelValue":a[1]||(a[1]=e=>t.searchData.resourceType=e),placeholder:"请选择"},{default:_((()=>[(n(!0),p(i,null,x(t.resourceTypes,(e=>(n(),T(m,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),u(h,{prop:"url",label:"资源链接"},{default:_((()=>[u(c,{modelValue:t.searchData.url,"onUpdate:modelValue":a[2]||(a[2]=e=>t.searchData.url=e),placeholder:"请输入"},null,8,["modelValue"])])),_:1}),u(h,{prop:"phone",label:"日期"},{default:_((()=>[u(f,{modelValue:t.searchData.data,"onUpdate:modelValue":a[3]||(a[3]=e=>t.searchData.data=e),type:"datetimerange","range-separator":"-","start-placeholder":"开始时间","end-placeholder":"结束时间"},null,8,["modelValue"])])),_:1}),u(h,null,{default:_((()=>[u(y,{type:"primary",onClick:t.init},{default:_((()=>[z("查询")])),_:1},8,["onClick"]),u(y,{onClick:t.resetSearch},{default:_((()=>[z("重置")])),_:1},8,["onClick"])])),_:1})])),_:1},8,["model"])])),_:1})),[[O,t.loading]]),t.echartsOptions.seriesName?(n(),T(v,{key:0,shadow:"always",class:"mt20 mb20"},{default:_((()=>[u(k,{echartsOptions:t.echartsOptions},null,8,["echartsOptions"])])),_:1})):S("",!0),C((n(),T(v,{shadow:"never"},{default:_((()=>[d("div",j,[u(P,{border:"",data:t.tableData},{default:_((()=>[u(w,{prop:"resourceType",label:"错误类型",align:"center"}),u(w,{prop:"errorMsg",label:"错误信息",align:"center"}),u(w,{prop:"html",label:"HTML内容",align:"center"}),u(w,{prop:"pageUrl",label:"上报页面",align:"center"}),u(w,{prop:"happenTime",label:"上报时间",align:"center"}),u(w,{label:"操作",fixed:"right",align:"center"},{default:_((({row:e})=>[u(y,{type:"text",onClick:a=>t.handleDetail(e)},{default:_((()=>[z(" 查看详情 ")])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"])]),d("div",N,[u(U,{background:"",layout:t.paginationData.layout,"page-sizes":t.paginationData.pageSizes,total:t.paginationData.total,"page-size":t.paginationData.pageSize,currentPage:t.paginationData.currentPage,onSizeChange:t.handleSizeChange,onCurrentChange:t.handleCurrentChange},null,8,["layout","page-sizes","total","page-size","currentPage","onSizeChange","onCurrentChange"])])])),_:1})),[[O,t.loading]])]),t.perfNode.resourceType?(n(),T(V,{key:0,perfNode:t.perfNode},null,8,["perfNode"])):S("",!0)],64)}],["__scopeId","data-v-fe652ed8"]]);export{O as default};
