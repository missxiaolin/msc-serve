import{u as e}from"./usePagination-8cf4a98b.js";import{b as a}from"./index-f12dd43e.js";import{d as l,g as t,c as r}from"./service-d7e6e336.js";import{i as o,g as s,R as i,_ as n,r as u,o as d,a as p,k as c,l as m,b as g,y as f,z as h}from"./index-79304586.js";const b={class:"app-container"},v={class:"flex"},C={class:"table-wrapper"},_={class:"pager-wrapper mt20 justify-end"};const F=n({setup(){const n=o({version:""});let u=s({isShowMapPop:!1,attFilesList:[],tableData:[],actionUrl:`${l}/adm/sourcemap/save`,headers:{Authorization:t()?`${t()}`:void 0,MonitorAppId:r("PROJECT_ID")}});const{paginationData:d,handleCurrentChange:p,handleSizeChange:c}=e((()=>{m()})),m=async()=>{let e={page:d.currentPage,pageSize:d.pageSize,...n.value},l=await a(e);l.success&&(d.total=l.model.count,u.tableData=l.model.list)},g=o(),f=o(),h=s({version:""}),b=s({version:[{required:!0,message:"请输入版本号",trigger:"blur"}]});return i((()=>{m()})),{searchData:n,data:u,initQuery:m,resetSearch:()=>{n.value={version:""},d.currentPage=1},handleCurrentChange:p,handleSizeChange:c,paginationData:d,handleClose:()=>{u.isShowMapPop=!1},ruleFormRef:f,ruleForm:h,rules:b,submitForm:async e=>{e&&await e.validate((async(e,a)=>{e&&g.value.submit()}))},uploadRef:g,successFile:async e=>{e.success&&(u.attFilesList=[],h.version="",u.isShowMapPop=!1,m())},resetForm:e=>{e&&(e.resetFields(),u.attFilesList=[])}}}},[["render",function(e,a,l,t,r,o){const s=u("el-input"),i=u("el-form-item"),n=u("el-button"),F=u("el-form"),y=u("el-card"),S=u("el-table-column"),z=u("el-table"),D=u("el-pagination"),w=u("el-upload"),P=u("el-dialog");return d(),p("div",b,[c(y,{shadow:"never",class:"search-wrapper"},{default:m((()=>[c(F,{ref:"searchFormRef",inline:!0,model:t.searchData},{default:m((()=>[c(i,{prop:"version",label:"版本号"},{default:m((()=>[c(s,{modelValue:t.searchData.version,"onUpdate:modelValue":a[0]||(a[0]=e=>t.searchData.version=e),placeholder:"请输入版本号"},null,8,["modelValue"])])),_:1}),c(i,null,{default:m((()=>[c(n,{type:"primary",onClick:t.initQuery},{default:m((()=>[f("查询")])),_:1},8,["onClick"]),c(n,{onClick:t.resetSearch},{default:m((()=>[f("重置")])),_:1},8,["onClick"])])),_:1})])),_:1},8,["model"])])),_:1}),g("div",v,[c(n,{type:"primary",onClick:a[1]||(a[1]=e=>t.data.isShowMapPop=!0)},{default:m((()=>[f("上传Sourcemap")])),_:1})]),c(y,{class:"mt20"},{default:m((()=>[g("div",C,[c(z,{border:"",data:t.data.tableData},{default:m((()=>[c(S,{prop:"id",label:"ID",align:"center"}),c(S,{prop:"filename",label:"文件名",align:"center"}),c(S,{prop:"version",label:"版本号",align:"center"}),c(S,{label:"存储大小",align:"center"},{default:m((({row:e})=>[f(h((e.size/1024).toFixed(2)),1)])),_:1}),c(S,{prop:"updateTime",label:"上传时间",align:"center"})])),_:1},8,["data"])]),g("div",_,[c(D,{background:"",layout:t.paginationData.layout,"page-sizes":t.paginationData.pageSizes,total:t.paginationData.total,"page-size":t.paginationData.pageSize,currentPage:t.paginationData.currentPage,onSizeChange:t.handleSizeChange,onCurrentChange:t.handleCurrentChange},null,8,["layout","page-sizes","total","page-size","currentPage","onSizeChange","onCurrentChange"])])])),_:1}),c(P,{modelValue:t.data.isShowMapPop,"onUpdate:modelValue":a[5]||(a[5]=e=>t.data.isShowMapPop=e),title:"上传Sourcemap",width:"60%","before-close":t.handleClose},{default:m((()=>[c(F,{ref:"ruleFormRef",model:t.ruleForm,rules:t.rules,"label-width":"120px",size:"default","status-icon":"",class:"pop-form"},{default:m((()=>[c(i,{label:"版本号",prop:"version"},{default:m((()=>[c(s,{modelValue:t.ruleForm.version,"onUpdate:modelValue":a[2]||(a[2]=e=>t.ruleForm.version=e)},null,8,["modelValue"])])),_:1}),c(i,{label:"文件"},{default:m((()=>[c(w,{multiple:"",ref:"uploadRef",class:"upload-demo","file-list":t.data.attFilesList,headers:t.data.headers,data:t.ruleForm,action:t.data.actionUrl,"auto-upload":!1,"on-success":t.successFile,accept:".map"},{trigger:m((()=>[c(n,{type:"primary"},{default:m((()=>[f("选择map文件")])),_:1})])),_:1},8,["file-list","headers","data","action","on-success"])])),_:1}),c(i,null,{default:m((()=>[c(n,{type:"primary",onClick:a[3]||(a[3]=e=>t.submitForm(t.ruleFormRef))},{default:m((()=>[f(" 保存 ")])),_:1}),c(n,{onClick:a[4]||(a[4]=e=>t.resetForm(t.ruleFormRef))},{default:m((()=>[f("重置")])),_:1})])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["modelValue","before-close"])])}],["__scopeId","data-v-32e82136"]]);export{F as default};
//# sourceMappingURL=list-f6db0630.js.map
