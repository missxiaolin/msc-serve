import{E as e}from"./index-7e38eb64.js";import{h as a,t as l}from"./index-12761950.js";import{i as t,w as r,_ as s,r as o,o as n,a as p,k as u,F as i,b as c,R as d,a8 as h,a9 as m,aa as g,ab as f,ac as y,ad as b,Q as v,ae as D,S as C,d as T,l as _,e as S,A as k,y as z}from"./index-ec675762.js";import{D as w}from"./detailPopup-a5210b39.js";import{r as x}from"./service-712b9305.js";import{u as U}from"./usePagination-cbf3122f.js";const V={components:{Echarts:e},props:{echartsOptions:{type:Object,required:!0}},setup(e){const l=t({}),s=()=>{let{seriesData:t=[],axisData:r=[],seriesName:s={}}=e.echartsOptions;t=t.map(((e,a)=>({...{name:s[a],type:"bar",barGap:0,emphasis:{focus:"series"},...e}}))),l.value={xAxis:{type:"category",data:r,axisLabel:{color:"#95979e",align:"center",formatter:(e,l)=>{const t=a(e).format("MM-DD HH:mm").split(" ");return`${t[0]}\n${t[1]}`}}},yAxis:{type:"value"},dataZoom:[{type:"inside"}],seriesColorReset:!0,series:[...t]}};return s(),r((()=>e.echartsOptions),(e=>{s()})),{options:l}}},P=c("div",{class:"flex"},null,-1);const R={class:"app-container"},N={class:"table-wrapper"},O={class:"pager-wrapper"};const j=s({name:"Resource",components:{ResHoursEchart:s(V,[["render",function(e,a,l,t,r,s){const c=o("Echarts");return n(),p(i,null,[P,u(c,{options:t.options},null,8,["options"])],64)}]]),DetailPopup:w},setup(){const e=t(!1),a=t({}),r=t([{value:"IMG",label:"IMG"},{value:"LINK",label:"LINK"},{value:"SCRIPT",label:"SCRIPT"}]),s=t({pageUrl:"",url:"",resourceType:"",data:l({format:["00:00:00","23:59:59"]})}),o=t({}),n=t([]),{paginationData:p,handleCurrentChange:u,handleSizeChange:i}=U((()=>{c()}));d((()=>{c(),D()}));const c=async()=>{let e={url:s.value.url,pageUrl:s.value.pageUrl,resourceType:s.value.resourceType,startTime:s.value.data[0],endTime:s.value.data[1],page:p.currentPage,pageSize:p.pageSize},a=await(l=e,x({url:"/adm/resource/list",method:"post",data:l}));var l;a.success&&(p.total=a.model.count,n.value=a.model.list)},D=async()=>{let e={startTime:s.value.data[0],endTime:s.value.data[1]},l=await(t=e,x({url:"/adm/resource/hour",method:"post",data:t}));var t;l.success&&(a.value=l.model)};return{resourceTypes:r,loading:e,searchData:s,resetSearch:()=>{s.value={pageUrl:"",url:"",resourceType:"",data:l({format:["00:00:00","23:59:59"]})},c(),D()},handleSearch:c,Search:h,Refresh:m,CirclePlus:g,RefreshRight:f,Delete:y,Download:b,tableData:n,paginationData:p,handleCurrentChange:u,handleSizeChange:i,handleDetail:e=>{o.value={},v((()=>o.value=e))},perfNode:o,init:async()=>{c(),D()},echartsOptions:a}}},[["render",function(e,a,l,t,r,s){const d=o("el-input"),h=o("el-form-item"),m=o("el-option"),g=o("el-select"),f=o("el-date-picker"),y=o("el-button"),b=o("el-form"),v=o("el-card"),w=o("ResHoursEchart"),x=o("el-table-column"),U=o("el-table"),V=o("el-pagination"),P=o("DetailPopup"),j=D("loading");return n(),p(i,null,[c("div",R,[C((n(),T(v,{shadow:"never",class:"search-wrapper"},{default:_((()=>[u(b,{ref:"searchFormRef",inline:!0,model:t.searchData},{default:_((()=>[u(h,{prop:"pageUrl",label:"页面链接"},{default:_((()=>[u(d,{modelValue:t.searchData.pageUrl,"onUpdate:modelValue":a[0]||(a[0]=e=>t.searchData.pageUrl=e),placeholder:"请输入"},null,8,["modelValue"])])),_:1}),u(h,{prop:"resourceType",label:"资源类型"},{default:_((()=>[u(g,{modelValue:t.searchData.resourceType,"onUpdate:modelValue":a[1]||(a[1]=e=>t.searchData.resourceType=e),placeholder:"请选择"},{default:_((()=>[(n(!0),p(i,null,k(t.resourceTypes,(e=>(n(),T(m,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),u(h,{prop:"url",label:"资源链接"},{default:_((()=>[u(d,{modelValue:t.searchData.url,"onUpdate:modelValue":a[2]||(a[2]=e=>t.searchData.url=e),placeholder:"请输入"},null,8,["modelValue"])])),_:1}),u(h,{prop:"phone",label:"日期"},{default:_((()=>[u(f,{modelValue:t.searchData.data,"onUpdate:modelValue":a[3]||(a[3]=e=>t.searchData.data=e),type:"datetimerange","range-separator":"-","start-placeholder":"开始时间","end-placeholder":"结束时间"},null,8,["modelValue"])])),_:1}),u(h,null,{default:_((()=>[u(y,{type:"primary",onClick:t.init},{default:_((()=>[z("查询")])),_:1},8,["onClick"]),u(y,{onClick:t.resetSearch},{default:_((()=>[z("重置")])),_:1},8,["onClick"])])),_:1})])),_:1},8,["model"])])),_:1})),[[j,t.loading]]),t.echartsOptions.seriesName?(n(),T(v,{key:0,shadow:"always",class:"mt20 mb20"},{default:_((()=>[u(w,{echartsOptions:t.echartsOptions},null,8,["echartsOptions"])])),_:1})):S("",!0),C((n(),T(v,{shadow:"never"},{default:_((()=>[c("div",N,[u(U,{border:"",data:t.tableData},{default:_((()=>[u(x,{prop:"resourceType",label:"错误类型",align:"center"}),u(x,{prop:"errorMsg",label:"错误信息",align:"center"}),u(x,{prop:"html",label:"HTML内容",align:"center"}),u(x,{prop:"pageUrl",label:"上报页面",align:"center"}),u(x,{prop:"happenTime",label:"上报时间",align:"center"}),u(x,{label:"操作",fixed:"right",align:"center"},{default:_((({row:e})=>[u(y,{type:"text",onClick:a=>t.handleDetail(e)},{default:_((()=>[z(" 查看详情 ")])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"])]),c("div",O,[u(V,{background:"",layout:t.paginationData.layout,"page-sizes":t.paginationData.pageSizes,total:t.paginationData.total,"page-size":t.paginationData.pageSize,currentPage:t.paginationData.currentPage,onSizeChange:t.handleSizeChange,onCurrentChange:t.handleCurrentChange},null,8,["layout","page-sizes","total","page-size","currentPage","onSizeChange","onCurrentChange"])])])),_:1})),[[j,t.loading]])]),t.perfNode.resourceType?(n(),T(P,{key:0,perfNode:t.perfNode},null,8,["perfNode"])):S("",!0)],64)}],["__scopeId","data-v-c81a3c6a"]]);export{j as default};
