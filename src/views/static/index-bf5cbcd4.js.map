{"version":3,"file":"index-bf5cbcd4.js","sources":["../../src/views/userBehavior/index.vue","../../src/api/userBehavior/index.ts"],"sourcesContent":["<template>\n  <div class=\"app-container\">\n    <el-card class=\"search-wrapper\">\n      <el-form ref=\"searchFormRef\" :inline=\"true\" :model=\"data.searchData\">\n        <el-form-item prop=\"uuId\" label=\"用户Id\">\n          <el-input v-model=\"data.searchData.uuId\" placeholder=\"请输入用户ID\" />\n        </el-form-item>\n        <el-form-item prop=\"categorys\" label=\"事件类型\">\n          <el-select\n            v-model=\"data.searchData.categorys\"\n            multiple\n            placeholder=\"请选择事件类型\"\n            style=\"width: 400px\"\n          >\n            <el-option\n              v-for=\"item in data.categoryOptions\"\n              :key=\"item.value\"\n              :label=\"item.label\"\n              :value=\"item.value\"\n            />\n          </el-select>\n        </el-form-item>\n        <el-form-item prop=\"phone\" label=\"日期\">\n          <el-date-picker\n            v-model=\"data.searchData.data\"\n            type=\"datetimerange\"\n            range-separator=\"-\"\n            start-placeholder=\"开始时间\"\n            end-placeholder=\"结束时间\"\n          />\n        </el-form-item>\n        <el-form-item>\n          <el-button type=\"primary\" @click=\"init\">查询</el-button>\n          <el-button @click=\"resetSearch\">重置</el-button>\n        </el-form-item>\n      </el-form>\n    </el-card>\n    <section\n      class=\"custom-main-contents visit-left-contents\"\n      ref=\"mainRef\"\n    >\n      <template v-if=\"data.userList && data.userList.length > 0\">\n        <el-card class=\"flex flex-1 flex-column visit-left-list\">\n          <div class=\"flex-1 flex flex-column\">\n            <el-scrollbar :max-height=\"`${data.height}px`\" style=\"flex: 1\">\n              <el-timeline>\n                <el-timeline-item\n                  v-for=\"(item, index) in data.userList\"\n                  :icon=\"\n                    item.category == 'USER_CLICK'\n                      ? 'Pointer'\n                      : item.category == 'HTTP_LOG'\n                      ? 'Position'\n                      : item.category == 'PAGE_CHANGE'\n                      ? 'Files'\n                      : item.category == 'JS_ERROR'\n                      ? 'CircleClose'\n                      : ''\n                  \"\n                  center\n                  :timestamp=\"item.happenTime\"\n                  placement=\"top\"\n                  :key=\"index\"\n                >\n                  <el-card style=\"width: 95%\">\n                    <template v-if=\"item.category == 'USER_CLICK'\">\n                      <p>{{ item.subType }}</p>\n                      <p>pageUrl: {{ item.pageUrl }}</p>\n                      <p>tagName: {{ item.tagName }}</p>\n                      <p>innerHTML: {{ item.innerHTML }}</p>\n                    </template>\n                    <template v-if=\"item.category == 'HTTP_LOG'\">\n                      <p>\n                        {{ item.subType }}请求方式:\n                        {{ item.method }} 请求方式:{{ item.type }} 接口状态:\n                        {{ item.status }} 耗时:{{\n                          timeformatter(item.duration)\n                        }}\n                      </p>\n                      <p>pageUrl: {{ item.pageUrl }}</p>\n                      <p>pathName: {{ item.pathName }}</p>\n                      <p>requestText: {{ item.requestText }}</p>\n                      <p>responseText: {{ item.responseText }}</p>\n                    </template>\n                    <template v-if=\"item.category == 'PAGE_CHANGE'\">\n                      <p>\n                        {{ item.subType }} 停留:{{\n                          timeformatter(item.duration)\n                        }}\n                      </p>\n                      <p>referrer: {{ item.referrer }}</p>\n                      <p>from: {{ item.from }}</p>\n                      <p>to: {{ item.to }}</p>\n                    </template>\n                    <template v-if=\"item.category == 'JS_ERROR'\">\n                      <p>{{ item.subType }}</p>\n                      <p>{{ item.errorMsg }}</p>\n                    </template>\n                  </el-card>\n                </el-timeline-item>\n              </el-timeline>\n            </el-scrollbar>\n            <div class=\"pager-wrapper mt20\">\n              <el-pagination\n                background\n                :layout=\"paginationData.layout\"\n                :page-sizes=\"paginationData.pageSizes\"\n                :total=\"paginationData.total\"\n                :page-size=\"paginationData.pageSize\"\n                :currentPage=\"paginationData.currentPage\"\n                @size-change=\"handleSizeChange\"\n                @current-change=\"handleCurrentChange\"\n              />\n            </div>\n          </div>\n        </el-card>\n        <div class=\"visit-right-contents\">\n          <div class=\"basic-header\">\n            <el-row>\n              <el-col :span=\"12\">cip： {{ data.pageDetail.ip }}</el-col>\n              <el-col :span=\"12\"\n                >cregion： {{ data.pageDetail.country }}</el-col\n              >\n              <el-col :span=\"12\"\n                >deviceType： {{ data.pageDetail.deviceType }}</el-col\n              >\n              <el-col :span=\"12\">os： {{ data.pageDetail.os }}</el-col>\n              <el-col :span=\"12\"\n                >browserInfo： {{ data.pageDetail.browserInfo }}</el-col\n              >\n              <el-col :span=\"12\">device： {{ data.pageDetail.device }}</el-col>\n              <el-col :span=\"12\"\n                >deviceModel： {{ data.pageDetail.deviceModel }}</el-col\n              >\n              <el-col :span=\"12\"\n                >language： {{ data.pageDetail.language }}</el-col\n              >\n              <el-col :span=\"12\"\n                >netWork： {{ data.pageDetail.netWork }}</el-col\n              >\n              <el-col :span=\"12\"></el-col>\n              <el-col :span=\"12\"\n                >userAgent： {{ data.pageDetail.userAgent }}</el-col\n              >\n            </el-row>\n          </div>\n        </div>\n      </template>\n      <template v-else>\n        <div class=\"flex flex-1 flex-row justify-center\">\n          <el-empty  description=\"未找到该用户记录\" />\n        </div>\n      </template>\n    </section>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { reactive, onMounted, ref, nextTick } from \"vue\";\nimport { timeQuantum, timeformatter } from \"@/utils/index\";\nimport { userBehavior } from \"@/api/userBehavior/index\";\nimport { usePagination } from \"@/hooks/usePagination\";\nimport { ElMessage } from \"element-plus\";\n\nexport default {\n  setup() {\n    let data = reactive({\n      height: 500,\n      searchData: {\n        uuId: \"\",\n        categorys: [\"PAGE_CHANGE\", \"USER_CLICK\", \"HTTP_LOG\", \"JS_ERROR\"],\n        data: timeQuantum({ format: [\"00:00:00\", \"23:59:59\"] }),\n      },\n      categoryOptions: [\n        {\n          value: \"PAGE_CHANGE\",\n          label: \"用户浏览\",\n        },\n        {\n          value: \"USER_CLICK\",\n          label: \"用户点击\",\n        },\n        {\n          value: \"HTTP_LOG\",\n          label: \"用户请求\",\n        },\n        {\n          value: \"JS_ERROR\",\n          label: \"JS错误\",\n        },\n      ],\n      pageDetail: <any>{},\n      userList: <any>[],\n    });\n\n    const { paginationData, handleCurrentChange, handleSizeChange } =\n      usePagination(() => {\n        getUserBehavior();\n      });\n\n    const getUserBehavior = async () => {\n      if (!data.searchData.uuId || !data.searchData.categorys) {\n        ElMessage(!data.searchData.uuId ? \"请输入用户ID\" : \"请选择事件类型\");\n\n        return;\n      }\n      let params = {\n        uuId: data.searchData.uuId,\n        categorys: data.searchData.categorys,\n        startTime: data.searchData.data[0],\n        endTime: data.searchData.data[1],\n        page: paginationData.currentPage,\n        pageSize: paginationData.pageSize,\n      };\n      let res = await userBehavior(params);\n      if (!res.success) {\n        data.pageDetail = {};\n        return;\n      }\n      data.pageDetail = res.model.pageDetail || {};\n      data.userList = res.model.userList || [];\n      paginationData.total = res.model.count;\n    };\n\n    const init = async () => {\n      paginationData.currentPage = 1;\n      paginationData.pageSize = 10;\n      getUserBehavior();\n    };\n    const resetSearch = () => {};\n\n    const mainRef = ref<any | null>(null);\n\n    onMounted(() => {\n      nextTick(() => {\n        data.height = mainRef.value.offsetHeight - 100;\n      });\n      init();\n    });\n    return {\n      data,\n      init,\n      resetSearch,\n      paginationData,\n      handleCurrentChange,\n      handleSizeChange,\n      timeformatter,\n      mainRef,\n    };\n  },\n};\n</script>\n\n<style lang=\"scss\" scoped>\n@use \"./style/style.scss\";\n</style>\n","import { request } from \"@/utils/service\";\nimport type * as UserBehavior from \"./modules/index\";\n\n/**\n * 用户行为记录\n * @returns\n */\nexport function userBehavior(data: UserBehavior.UserBehaviorRequestData) {\n  return request<UserBehavior.UserBehaviorResponseData>({\n    url: \"/adm/get/user/behavior\",\n    method: \"post\",\n    data,\n  });\n}\n"],"names":["_hoisted_1","class","_hoisted_2","_hoisted_3","_hoisted_4","_hoisted_7","key","setup","data","reactive","height","searchData","uuId","categorys","timeQuantum","format","categoryOptions","value","label","pageDetail","userList","paginationData","handleCurrentChange","handleSizeChange","usePagination","getUserBehavior","async","ElMessage","params","startTime","endTime","page","currentPage","pageSize","res","request","url","method","userBehavior","success","model","total","count","init","mainRef","ref","onMounted","nextTick","offsetHeight","resetSearch","timeformatter","_component_el_empty","_resolveComponent","_createElementBlock","_createVNode","_component_el_card","default","_withCtx","_component_el_form","inline","$setup","_component_el_form_item","prop","_component_el_input","modelValue","_cache","$event","_","_component_el_select","multiple","placeholder","style","width","_openBlock","_Fragment","_renderList","item","_createBlock","_component_el_option","_component_el_date_picker","type","_component_el_button","onClick","length","_createElementVNode","_component_el_scrollbar","flex","_component_el_timeline","index","_component_el_timeline_item","icon","category","center","timestamp","happenTime","placement","_toDisplayString","subType","pageUrl","tagName","_createCommentVNode","status","duration","pathName","requestText","referrer","from","_component_el_pagination","background","layout","pageSizes","onSizeChange","_hoisted_5","_hoisted_6","_component_el_row","_component_el_col","span"],"mappings":"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"}