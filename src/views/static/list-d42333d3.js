import{P as e,p as a}from"./index-9e91f4e4.js";import{m as l,c as t,r as n,o as r,d as o,l as d,k as i,i as p,_ as u,b as s,x as c,y as f,a as m,F as g,e as h,M as b,N as v,R as _,a8 as F,a9 as D,aa as P,ab as C,ac as w,ad as S,Q as y,ae as N,S as x}from"./index-3ec52a71.js";import{t as T}from"./index-13555ce2.js";import{u as R}from"./usePagination-ab918a90.js";import"./index-fa744201.js";import"./service-0bae86ac.js";const z={components:{PerfEchart:e,PerfResTable:l({__name:"perfResTable",props:{data:{type:Array,defualt:()=>[]}},setup(e){const a=e,l=t((()=>{const e=["startTime","responseEnd","duration","dns","tcp","ssl","ttfb","contentDownload"];if(!a.data||!a.data.length)return[];return a.data.map((a=>{for(let l in a)e.includes(l)&&(a[l]=(a[l]||0).toFixed(2)+"ms");return a}))}));return(e,a)=>{const t=n("el-table-column"),p=n("el-table");return r(),o(p,{data:l.value,stripe:"","max-height":"500"},{default:d((()=>[i(t,{prop:"name",label:"资源名称",fixed:"",width:"200"}),i(t,{prop:"transferSize",label:"资源大小",fixed:""}),i(t,{prop:"initiatorType",label:"资源类型"}),i(t,{prop:"startTime",label:"开始时间"}),i(t,{prop:"responseEnd",label:"结束时间"}),i(t,{prop:"duration",label:"资源的总耗时"}),i(t,{prop:"dns",label:"DNS"}),i(t,{prop:"tcp",label:"TCP"}),i(t,{prop:"ssl",label:"SSL"}),i(t,{prop:"ttfb",label:"请求耗时"}),i(t,{prop:"contentDownload",label:"资源下载时间"}),i(t,{prop:"renderBlockingStatus",label:"否有渲染阻塞",fixed:"right"}),i(t,{prop:"isCache",label:"命中缓存",fixed:"right"})])),_:1},8,["data"])}}})},props:{perfNode:{type:Object,required:!0}},name:"perfDetail",setup(e){const{perfNode:a}=e;return{drawerVisible:p(!0),perfEchartOPtion:t((()=>({NT:(null==a?void 0:a.nt)||{},FP:(null==a?void 0:a.fp)||{},FCP:(null==a?void 0:a.fcp)||{}})))}}},k=e=>(b("data-v-747e13c8"),e=e(),v(),e),U={class:"detail-wapper flex-1"},V={class:"detail-top-content"},I={class:"flex basic-info"},j={class:"other-basic"},E={class:"detail-bottom-content flex flex-1"},L={class:"navigation-content"},O=k((()=>s("h2",{class:"title"},"会话性能指标",-1))),B={class:"flex navigation-target"},M=k((()=>s("p",null,null,-1))),A=k((()=>s("p",null,null,-1))),q=k((()=>s("p",null,null,-1))),H=k((()=>s("p",null,null,-1))),Q=k((()=>s("p",null,null,-1))),G=k((()=>s("p",null,null,-1))),J=k((()=>s("p",null,null,-1))),K=k((()=>s("p",null,null,-1))),W=k((()=>s("h2",{class:"title"},"页面加载瀑布图",-1))),X=k((()=>s("h2",{class:"title"},"会话性能指标",-1))),Y=k((()=>s("h3",{class:"title"},"FP 白屏资源",-1))),Z=k((()=>s("h3",{class:"title"},"FCP 灰屏资源",-1))),$=k((()=>s("h3",{class:"title"},"RF 资源",-1)));const ee={class:"app-container"},ae={class:"table-wrapper"},le={class:"pager-wrapper"};const te=u({name:"Performance",components:{PerfDetail:u(z,[["render",function(e,a,l,t,p,u){const b=n("Edit"),v=n("el-icon"),_=n("Clock"),F=n("Location"),D=n("Document"),P=n("Postcard"),C=n("FolderRemove"),w=n("el-tooltip"),S=n("PerfEchart"),y=n("PerfResTable"),N=n("el-scroll"),x=n("el-drawer");return r(),o(x,{modelValue:t.drawerVisible,"onUpdate:modelValue":a[0]||(a[0]=e=>t.drawerVisible=e),ref:"drawerRef",title:"性能指标查看",direction:"rtl",size:"95%","z-index":9999,"append-to-body":!0},{default:d((()=>{var e,a,n,o,p,u,x;return[s("section",U,[s("div",V,[s("dl",I,[s("dd",null,[i(v,{size:15},{default:d((()=>[i(b)])),_:1}),c(f(null==(e=l.perfNode)?void 0:e.uuId),1)]),s("dd",null,[i(v,{size:15},{default:d((()=>[i(_)])),_:1}),c(f(null==(a=l.perfNode)?void 0:a.happenTime),1)]),s("dd",null,[i(v,null,{default:d((()=>[i(F)])),_:1}),c(f(null==(n=l.perfNode)?void 0:n.country),1)]),s("dd",null,[i(v,null,{default:d((()=>[i(D)])),_:1}),c(f(null==(o=l.perfNode)?void 0:o.browserInfo),1)]),s("dd",null,[i(v,null,{default:d((()=>[i(P)])),_:1}),c(f(null==(p=l.perfNode)?void 0:p.os),1)]),s("dd",null,[i(v,null,{default:d((()=>[i(C)])),_:1}),c(f(null==(u=l.perfNode)?void 0:u.device),1)])]),s("div",j,f(null==(x=l.perfNode)?void 0:x.pageUrl),1)]),s("div",E,[i(N,{ref:"scrollbarRef",trigger:"hover",class:"flex-1",direction:"all"},{default:d((()=>{var e,a,n,o,p,u,f;return[s("div",L,[O,s("dl",B,[s("dd",null,[c(" CLS"),i(w,{content:" --",placement:"top"},{default:d((()=>[M])),_:1})]),s("dd",null,[c(" FCP"),i(w,{content:" --",placement:"top"},{default:d((()=>[A])),_:1})]),s("dd",null,[c(" FID"),i(w,{content:" --",placement:"top"},{default:d((()=>[q])),_:1})]),s("dd",null,[c(" FMP"),i(w,{content:" --",placement:"top"},{default:d((()=>[H])),_:1})]),s("dd",null,[c(" FP"),i(w,{content:" --",placement:"top"},{default:d((()=>[Q])),_:1})]),s("dd",null,[c(" LCP"),i(w,{content:" --",placement:"top"},{default:d((()=>[G])),_:1})]),s("dd",null,[c(" MPFID"),i(w,{content:" --",placement:"top"},{default:d((()=>[J])),_:1})]),s("dd",null,[c(" TTI"),i(w,{content:" --",placement:"top"},{default:d((()=>[K])),_:1})])]),W,s("div",null,[i(S,{options:t.perfEchartOPtion},null,8,["options"])]),X,s("div",null,[(null==(e=l.perfNode)?void 0:e.fp)?(r(),m(g,{key:0},[Y,i(y,{data:null==(n=null==(a=l.perfNode)?void 0:a.fp)?void 0:n.RF},null,8,["data"])],64)):h("",!0),(null==(o=l.perfNode)?void 0:o.fcp)?(r(),m(g,{key:1},[Z,i(y,{data:null==(u=null==(p=l.perfNode)?void 0:p.fcp)?void 0:u.RF},null,8,["data"])],64)):h("",!0),$,i(y,{data:null==(f=l.perfNode)?void 0:f.rf},null,8,["data"])])])]})),_:1},512)])])]})),_:1},8,["modelValue"])}],["__scopeId","data-v-747e13c8"]])},setup(){const e=p(!1),l=p({pageUrl:"",data:T({format:["00:00:00","23:59:59"]})}),t=p({}),n=p([]),{paginationData:r,handleCurrentChange:o,handleSizeChange:d}=R((()=>{i()}));_((()=>{i()}));const i=()=>{return e=this,t=null,o=function*(){let e={pageUrl:l.value.pageUrl,startTime:l.value.data[0],endTime:l.value.data[1],page:r.currentPage,pageSize:r.pageSize},t=yield a(e);t.success&&(r.total=t.model.count,n.value=t.model.list)},new Promise(((a,l)=>{var n=e=>{try{d(o.next(e))}catch(a){l(a)}},r=e=>{try{d(o.throw(e))}catch(a){l(a)}},d=e=>e.done?a(e.value):Promise.resolve(e.value).then(n,r);d((o=o.apply(e,t)).next())}));var e,t,o};return{loading:e,searchData:l,resetSearch:()=>{l.value={pageUrl:"",data:T({format:["00:00:00","23:59:59"]})},r.currentPage=1,i()},handleSearch:i,Search:F,Refresh:D,CirclePlus:P,RefreshRight:C,Delete:w,Download:S,tableData:n,paginationData:r,handleCurrentChange:o,handleSizeChange:d,ntFormat:(e,a)=>{let l=e.nt&&e.nt[a]||0;const t=e.fp,n=e.fpc;return"fp"==a&&t&&(l=t.startTime),"fpc"==a&&n&&(l=n.startTime),e.nt||l?l.toFixed(2)+"ms":"-"},handleDetail:e=>{t.value={},y((()=>t.value=e))},perfNode:t}}},[["render",function(e,a,l,t,p,u){const b=n("el-input"),v=n("el-form-item"),_=n("el-date-picker"),F=n("el-button"),D=n("el-form"),P=n("el-card"),C=n("el-table-column"),w=n("Histogram"),S=n("el-icon"),y=n("el-table"),T=n("el-pagination"),R=n("PerfDetail"),z=N("loading");return r(),m(g,null,[s("div",ee,[x((r(),o(P,{shadow:"never",class:"search-wrapper"},{default:d((()=>[i(D,{ref:"searchFormRef",inline:!0,model:t.searchData},{default:d((()=>[i(v,{prop:"pageUrl",label:"页面链接"},{default:d((()=>[i(b,{modelValue:t.searchData.pageUrl,"onUpdate:modelValue":a[0]||(a[0]=e=>t.searchData.pageUrl=e),placeholder:"请输入"},null,8,["modelValue"])])),_:1}),i(v,{prop:"phone",label:"日期"},{default:d((()=>[i(_,{modelValue:t.searchData.data,"onUpdate:modelValue":a[1]||(a[1]=e=>t.searchData.data=e),type:"datetimerange","range-separator":"-","start-placeholder":"开始时间","end-placeholder":"结束时间"},null,8,["modelValue"])])),_:1}),i(v,null,{default:d((()=>[i(F,{type:"primary",onClick:t.handleSearch},{default:d((()=>[c("查询")])),_:1},8,["onClick"]),i(F,{onClick:t.resetSearch},{default:d((()=>[c("重置")])),_:1},8,["onClick"])])),_:1})])),_:1},8,["model"])])),_:1})),[[z,t.loading]]),x((r(),o(P,{shadow:"never"},{default:d((()=>[s("div",ae,[i(y,{border:"",data:t.tableData},{default:d((()=>[i(C,{prop:"monitorAppId",label:"项目ID",align:"center"}),i(C,{prop:"pageUrl",label:"url",align:"center"}),i(C,{label:"会话性能指标",align:"center"},{default:d((()=>[i(C,{label:"Navigation 指标",align:"center"},{default:d((()=>[i(C,{label:"DNS 查询"},{default:d((({row:e})=>[c(f(t.ntFormat(e,"DNS")),1)])),_:1}),i(C,{label:"TCP 链接"},{default:d((({row:e})=>[c(f(t.ntFormat(e,"TCP")),1)])),_:1}),i(C,{label:"SSL 建连"},{default:d((({row:e})=>[c(f(t.ntFormat(e,"SSL")),1)])),_:1}),i(C,{label:"TTFB 请求响应"},{default:d((({row:e})=>[c(f(t.ntFormat(e,"TTFB")),1)])),_:1}),i(C,{label:"TRANS 内容传输"},{default:d((({row:e})=>[c(f(t.ntFormat(e,"Trans")),1)])),_:1}),i(C,{label:"DOM 解析"},{default:d((({row:e})=>[c(f(t.ntFormat(e,"DomParse")),1)])),_:1}),i(C,{label:"RES 资源加载"},{default:d((({row:e})=>[c(f(t.ntFormat(e,"Res")),1)])),_:1})])),_:1}),i(C,{label:"性能关键指标",align:"center"},{default:d((()=>[i(C,{label:"白屏时间"},{default:d((({row:e})=>[c(f(t.ntFormat(e,"FP")),1)])),_:1}),i(C,{label:"FCP 灰屏时间"},{default:d((({row:e})=>[c(f(t.ntFormat(e,"FPC")),1)])),_:1}),i(C,{label:"FirseByte 首字节"},{default:d((({row:e})=>[c(f(t.ntFormat(e,"FirseByte")),1)])),_:1}),i(C,{label:"DOMReady"},{default:d((({row:e})=>[c(f(t.ntFormat(e,"DomReady")),1)])),_:1}),i(C,{label:"LOAD 加载完成"},{default:d((({row:e})=>[c(f(t.ntFormat(e,"Load")),1)])),_:1})])),_:1})])),_:1}),i(C,{label:"性能图表",fixed:"right",align:"center"},{default:d((({row:e})=>[i(F,{type:"text",onClick:a=>t.handleDetail(e)},{default:d((()=>[i(S,{style:{"vertical-align":"middle"}},{default:d((()=>[i(w)])),_:1})])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"])]),s("div",le,[i(T,{background:"",layout:t.paginationData.layout,"page-sizes":t.paginationData.pageSizes,total:t.paginationData.total,"page-size":t.paginationData.pageSize,currentPage:t.paginationData.currentPage,onSizeChange:t.handleSizeChange,onCurrentChange:t.handleCurrentChange},null,8,["layout","page-sizes","total","page-size","currentPage","onSizeChange","onCurrentChange"])])])),_:1})),[[z,t.loading]])]),t.perfNode.simpleUrl?(r(),o(R,{key:0,perfNode:t.perfNode},null,8,["perfNode"])):h("",!0)],64)}],["__scopeId","data-v-31c03c9b"]]);export{te as default};
