import{t as e,a}from"./index-fc9f7a24.js";import{r as t}from"./service-27f2630d.js";import{u as l}from"./usePagination-346beb36.js";import{g as r,i as n,R as s,Q as i,K as o,_ as u,r as d,o as p,a as c,k as g,l as f,b as m,F as h,A as y,y as _,z as D,d as C,e as v}from"./index-c4490d7a.js";const T={class:"app-container"},b={class:"custom-main-contents visit-left-contents visit-right-contents",ref:"mainRef"},x={class:"flex-1 flex flex-column"},S={class:"pager-wrapper mt20"},R={class:"visit-right-contents"},I={class:"basic-header"},k={key:1,class:"flex flex-1 flex-row justify-center"};const E=u({setup(){let u=r({height:500,searchData:{uuId:"",categorys:["PAGE_CHANGE","USER_CLICK","HTTP_LOG","JS_ERROR"],data:e({format:["00:00:00","23:59:59"]})},categoryOptions:[{value:"PAGE_CHANGE",label:"用户浏览"},{value:"USER_CLICK",label:"用户点击"},{value:"HTTP_LOG",label:"用户请求"},{value:"JS_ERROR",label:"JS错误"}],pageDetail:{},userList:[]});const{paginationData:d,handleCurrentChange:p,handleSizeChange:c}=l((()=>{g()})),g=async()=>{if(!u.searchData.uuId||!u.searchData.categorys)return void o(u.searchData.uuId?"请选择事件类型":"请输入用户ID");let e={uuId:u.searchData.uuId,categorys:u.searchData.categorys,startTime:u.searchData.data[0],endTime:u.searchData.data[1],page:d.currentPage,pageSize:d.pageSize},a=await function(e){return t({url:"/adm/get/user/behavior",method:"post",data:e})}(e);a.success?(u.pageDetail=a.model.pageDetail||{},u.userList=a.model.userList||[],d.total=a.model.count):u.pageDetail={}},f=async()=>{d.currentPage=1,d.pageSize=10,g()},m=n(null);return s((()=>{i((()=>{u.height=m.value.offsetHeight-100})),f()})),{data:u,init:f,resetSearch:()=>{},paginationData:d,handleCurrentChange:p,handleSizeChange:c,timeformatter:a,mainRef:m}}},[["render",function(e,a,t,l,r,n){const s=d("el-input"),i=d("el-form-item"),o=d("el-option"),u=d("el-select"),E=d("el-date-picker"),L=d("el-button"),P=d("el-form"),z=d("el-card"),G=d("el-timeline-item"),A=d("el-timeline"),H=d("el-scrollbar"),U=d("el-pagination"),O=d("el-col"),w=d("el-row"),V=d("el-empty");return p(),c("div",T,[g(z,{class:"search-wrapper"},{default:f((()=>[g(P,{ref:"searchFormRef",inline:!0,model:l.data.searchData},{default:f((()=>[g(i,{prop:"uuId",label:"用户Id"},{default:f((()=>[g(s,{modelValue:l.data.searchData.uuId,"onUpdate:modelValue":a[0]||(a[0]=e=>l.data.searchData.uuId=e),placeholder:"请输入用户ID"},null,8,["modelValue"])])),_:1}),g(i,{prop:"categorys",label:"事件类型"},{default:f((()=>[g(u,{modelValue:l.data.searchData.categorys,"onUpdate:modelValue":a[1]||(a[1]=e=>l.data.searchData.categorys=e),multiple:"",placeholder:"请选择事件类型",style:{width:"400px"}},{default:f((()=>[(p(!0),c(h,null,y(l.data.categoryOptions,(e=>(p(),C(o,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),g(i,{prop:"phone",label:"日期"},{default:f((()=>[g(E,{modelValue:l.data.searchData.data,"onUpdate:modelValue":a[2]||(a[2]=e=>l.data.searchData.data=e),type:"datetimerange","range-separator":"-","start-placeholder":"开始时间","end-placeholder":"结束时间"},null,8,["modelValue"])])),_:1}),g(i,null,{default:f((()=>[g(L,{type:"primary",onClick:l.init},{default:f((()=>[_("查询")])),_:1},8,["onClick"]),g(L,{onClick:l.resetSearch},{default:f((()=>[_("重置")])),_:1},8,["onClick"])])),_:1})])),_:1},8,["model"])])),_:1}),m("section",b,[l.data.userList&&l.data.userList.length>0?(p(),c(h,{key:0},[g(z,{class:"flex flex-1 flex-column visit-left-list"},{default:f((()=>[m("div",x,[g(H,{"max-height":`${l.data.height}px`,style:{flex:"1"}},{default:f((()=>[g(A,null,{default:f((()=>[(p(!0),c(h,null,y(l.data.userList,((e,a)=>(p(),C(G,{icon:"USER_CLICK"==e.category?"Pointer":"HTTP_LOG"==e.category?"Position":"PAGE_CHANGE"==e.category?"Files":"JS_ERROR"==e.category?"CircleClose":"",center:"",timestamp:e.happenTime,placement:"top",key:a},{default:f((()=>[g(z,{style:{width:"95%"}},{default:f((()=>["USER_CLICK"==e.category?(p(),c(h,{key:0},[m("p",null,D(e.subType),1),m("p",null,"pageUrl: "+D(e.pageUrl),1),m("p",null,"tagName: "+D(e.tagName),1),m("p",null,"innerHTML: "+D(e.innerHTML),1)],64)):v("",!0),"HTTP_LOG"==e.category?(p(),c(h,{key:1},[m("p",null,D(e.subType)+"请求方式: "+D(e.method)+" 请求方式:"+D(e.type)+" 接口状态: "+D(e.status)+" 耗时:"+D(l.timeformatter(e.duration)),1),m("p",null,"pageUrl: "+D(e.pageUrl),1),m("p",null,"pathName: "+D(e.pathName),1),m("p",null,"requestText: "+D(e.requestText),1),m("p",null,"responseText: "+D(e.responseText),1)],64)):v("",!0),"PAGE_CHANGE"==e.category?(p(),c(h,{key:2},[m("p",null,D(e.subType)+" 停留:"+D(l.timeformatter(e.duration)),1),m("p",null,"referrer: "+D(e.referrer),1),m("p",null,"from: "+D(e.from),1),m("p",null,"to: "+D(e.to),1)],64)):v("",!0),"JS_ERROR"==e.category?(p(),c(h,{key:3},[m("p",null,D(e.subType),1),m("p",null,D(e.errorMsg),1)],64)):v("",!0)])),_:2},1024)])),_:2},1032,["icon","timestamp"])))),128))])),_:1})])),_:1},8,["max-height"]),m("div",S,[g(U,{background:"",layout:l.paginationData.layout,"page-sizes":l.paginationData.pageSizes,total:l.paginationData.total,"page-size":l.paginationData.pageSize,currentPage:l.paginationData.currentPage,onSizeChange:l.handleSizeChange,onCurrentChange:l.handleCurrentChange},null,8,["layout","page-sizes","total","page-size","currentPage","onSizeChange","onCurrentChange"])])])])),_:1}),m("div",R,[m("div",I,[g(w,null,{default:f((()=>[g(O,{span:12},{default:f((()=>[_("cip： "+D(l.data.pageDetail.ip),1)])),_:1}),g(O,{span:12},{default:f((()=>[_("cregion： "+D(l.data.pageDetail.country),1)])),_:1}),g(O,{span:12},{default:f((()=>[_("deviceType： "+D(l.data.pageDetail.deviceType),1)])),_:1}),g(O,{span:12},{default:f((()=>[_("os： "+D(l.data.pageDetail.os),1)])),_:1}),g(O,{span:12},{default:f((()=>[_("browserInfo： "+D(l.data.pageDetail.browserInfo),1)])),_:1}),g(O,{span:12},{default:f((()=>[_("device： "+D(l.data.pageDetail.device),1)])),_:1}),g(O,{span:12},{default:f((()=>[_("deviceModel： "+D(l.data.pageDetail.deviceModel),1)])),_:1}),g(O,{span:12},{default:f((()=>[_("language： "+D(l.data.pageDetail.language),1)])),_:1}),g(O,{span:12},{default:f((()=>[_("netWork： "+D(l.data.pageDetail.netWork),1)])),_:1}),g(O,{span:12}),g(O,{span:12},{default:f((()=>[_("userAgent： "+D(l.data.pageDetail.userAgent),1)])),_:1})])),_:1})])])],64)):(p(),c("div",k,[g(V,{description:"未找到该用户记录"})]))],512)])}],["__scopeId","data-v-730656f9"]]);export{E as default};
//# sourceMappingURL=index-09fc8c70.js.map
