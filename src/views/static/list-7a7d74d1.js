import{u as e,p as t,a as o}from"./general-3383381a.js";import{u as r}from"./usePagination-b7e3914f.js";import{ai as n,t as a,g as l,i,c as u,R as c,K as s,_ as d,r as p,o as f,a as m,b as y,k as b,l as h,y as g,z as v,F as w,A as S,d as x,M as C,N as k}from"./index-46206729.js";import"./service-e4a28945.js";var _={exports:{}};const E=a(_.exports=function(){return function(){var e={686:function(e,t,o){o.d(t,{default:function(){return x}});var r=o(279),n=o.n(r),a=o(370),l=o.n(a),i=o(817),u=o.n(i);function c(e){try{return document.execCommand(e)}catch(t){return!1}}var s=function(e){var t=u()(e);return c("cut"),t},d=function(e,t){var o=function(e){var t="rtl"===document.documentElement.getAttribute("dir"),o=document.createElement("textarea");o.style.fontSize="12pt",o.style.border="0",o.style.padding="0",o.style.margin="0",o.style.position="absolute",o.style[t?"right":"left"]="-9999px";var r=window.pageYOffset||document.documentElement.scrollTop;return o.style.top="".concat(r,"px"),o.setAttribute("readonly",""),o.value=e,o}(e);t.container.appendChild(o);var r=u()(o);return c("copy"),o.remove(),r},p=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{container:document.body},o="";return"string"==typeof e?o=d(e,t):e instanceof HTMLInputElement&&!["text","search","url","tel","password"].includes(null==e?void 0:e.type)?o=d(e.value,t):(o=u()(e),c("copy")),o};function f(e){return(f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var m=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.action,o=void 0===t?"copy":t,r=e.container,n=e.target,a=e.text;if("copy"!==o&&"cut"!==o)throw new Error('Invalid "action" value, use either "copy" or "cut"');if(void 0!==n){if(!n||"object"!==f(n)||1!==n.nodeType)throw new Error('Invalid "target" value, use a valid Element');if("copy"===o&&n.hasAttribute("disabled"))throw new Error('Invalid "target" attribute. Please use "readonly" instead of "disabled" attribute');if("cut"===o&&(n.hasAttribute("readonly")||n.hasAttribute("disabled")))throw new Error('Invalid "target" attribute. You can\'t cut text from elements with "readonly" or "disabled" attributes')}return a?p(a,{container:r}):n?"cut"===o?s(n):p(n,{container:r}):void 0};function y(e){return(y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function b(e,t){for(var o=0;o<t.length;o++){var r=t[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function h(e,t){return(h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function g(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var o,r,n,a=v(e);if(t){var l=v(this).constructor;o=Reflect.construct(a,arguments,l)}else o=a.apply(this,arguments);return r=this,!(n=o)||"object"!==y(n)&&"function"!=typeof n?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(r):n}}function v(e){return(v=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function w(e,t){var o="data-clipboard-".concat(e);if(t.hasAttribute(o))return t.getAttribute(o)}var S=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&h(e,t)}(a,e);var t,o,r,n=g(a);function a(e,t){var o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(o=n.call(this)).resolveOptions(t),o.listenClick(e),o}return t=a,o=[{key:"resolveOptions",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.action="function"==typeof e.action?e.action:this.defaultAction,this.target="function"==typeof e.target?e.target:this.defaultTarget,this.text="function"==typeof e.text?e.text:this.defaultText,this.container="object"===y(e.container)?e.container:document.body}},{key:"listenClick",value:function(e){var t=this;this.listener=l()(e,"click",(function(e){return t.onClick(e)}))}},{key:"onClick",value:function(e){var t=e.delegateTarget||e.currentTarget,o=this.action(t)||"copy",r=m({action:o,container:this.container,target:this.target(t),text:this.text(t)});this.emit(r?"success":"error",{action:o,text:r,trigger:t,clearSelection:function(){t&&t.focus(),window.getSelection().removeAllRanges()}})}},{key:"defaultAction",value:function(e){return w("action",e)}},{key:"defaultTarget",value:function(e){var t=w("target",e);if(t)return document.querySelector(t)}},{key:"defaultText",value:function(e){return w("text",e)}},{key:"destroy",value:function(){this.listener.destroy()}}],r=[{key:"copy",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{container:document.body};return p(e,t)}},{key:"cut",value:function(e){return s(e)}},{key:"isSupported",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:["copy","cut"],t="string"==typeof e?[e]:e,o=!!document.queryCommandSupported;return t.forEach((function(e){o=o&&!!document.queryCommandSupported(e)})),o}}],o&&b(t.prototype,o),r&&b(t,r),a}(n()),x=S},828:function(e){if("undefined"!=typeof Element&&!Element.prototype.matches){var t=Element.prototype;t.matches=t.matchesSelector||t.mozMatchesSelector||t.msMatchesSelector||t.oMatchesSelector||t.webkitMatchesSelector}e.exports=function(e,t){for(;e&&9!==e.nodeType;){if("function"==typeof e.matches&&e.matches(t))return e;e=e.parentNode}}},438:function(e,t,o){var r=o(828);function n(e,t,o,r,n){var l=a.apply(this,arguments);return e.addEventListener(o,l,n),{destroy:function(){e.removeEventListener(o,l,n)}}}function a(e,t,o,n){return function(o){o.delegateTarget=r(o.target,t),o.delegateTarget&&n.call(e,o)}}e.exports=function(e,t,o,r,a){return"function"==typeof e.addEventListener?n.apply(null,arguments):"function"==typeof o?n.bind(null,document).apply(null,arguments):("string"==typeof e&&(e=document.querySelectorAll(e)),Array.prototype.map.call(e,(function(e){return n(e,t,o,r,a)})))}},879:function(e,t){t.node=function(e){return void 0!==e&&e instanceof HTMLElement&&1===e.nodeType},t.nodeList=function(e){var o=Object.prototype.toString.call(e);return void 0!==e&&("[object NodeList]"===o||"[object HTMLCollection]"===o)&&"length"in e&&(0===e.length||t.node(e[0]))},t.string=function(e){return"string"==typeof e||e instanceof String},t.fn=function(e){return"[object Function]"===Object.prototype.toString.call(e)}},370:function(e,t,o){var r=o(879),n=o(438);e.exports=function(e,t,o){if(!e&&!t&&!o)throw new Error("Missing required arguments");if(!r.string(t))throw new TypeError("Second argument must be a String");if(!r.fn(o))throw new TypeError("Third argument must be a Function");if(r.node(e))return function(e,t,o){return e.addEventListener(t,o),{destroy:function(){e.removeEventListener(t,o)}}}(e,t,o);if(r.nodeList(e))return function(e,t,o){return Array.prototype.forEach.call(e,(function(e){e.addEventListener(t,o)})),{destroy:function(){Array.prototype.forEach.call(e,(function(e){e.removeEventListener(t,o)}))}}}(e,t,o);if(r.string(e))return function(e,t,o){return n(document.body,e,t,o)}(e,t,o);throw new TypeError("First argument must be a String, HTMLElement, HTMLCollection, or NodeList")}},817:function(e){e.exports=function(e){var t;if("SELECT"===e.nodeName)e.focus(),t=e.value;else if("INPUT"===e.nodeName||"TEXTAREA"===e.nodeName){var o=e.hasAttribute("readonly");o||e.setAttribute("readonly",""),e.select(),e.setSelectionRange(0,e.value.length),o||e.removeAttribute("readonly"),t=e.value}else{e.hasAttribute("contenteditable")&&e.focus();var r=window.getSelection(),n=document.createRange();n.selectNodeContents(e),r.removeAllRanges(),r.addRange(n),t=r.toString()}return t}},279:function(e){function t(){}t.prototype={on:function(e,t,o){var r=this.e||(this.e={});return(r[e]||(r[e]=[])).push({fn:t,ctx:o}),this},once:function(e,t,o){var r=this;function n(){r.off(e,n),t.apply(o,arguments)}return n._=t,this.on(e,n,o)},emit:function(e){for(var t=[].slice.call(arguments,1),o=((this.e||(this.e={}))[e]||[]).slice(),r=0,n=o.length;r<n;r++)o[r].fn.apply(o[r].ctx,t);return this},off:function(e,t){var o=this.e||(this.e={}),r=o[e],n=[];if(r&&t)for(var a=0,l=r.length;a<l;a++)r[a].fn!==t&&r[a].fn._!==t&&n.push(r[a]);return n.length?o[e]=n:delete o[e],this}},e.exports=t,e.exports.TinyEmitter=t}},t={};function o(r){if(t[r])return t[r].exports;var n=t[r]={exports:{}};return e[r](n,n.exports,o),n.exports}return o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,{a:t}),t},o.d=function(e,t){for(var r in t)o.o(t,r)&&!o.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o(686)}().default}()),{toClipboard:T}=(e=>{const t=void 0===(null==e?void 0:e.appendToBody)||e.appendToBody;return{toClipboard:(e,o)=>new Promise(((r,n)=>{const a=document.createElement("button"),l=new E(a,{text:()=>e,action:()=>"copy",container:void 0!==o?o:document.body});l.on("success",(e=>{l.destroy(),r(e)})),l.on("error",(e=>{l.destroy(),n(e)})),t&&document.body.appendChild(a),a.click(),t&&document.body.removeChild(a)}))}})(),F=e(),j={setup(){let e=l({isShowPorjectPop:!1,tableData:[],watchList:[{label:"PV",value:"pageChange",disabled:!0},{label:"JS错误",value:"jsError"},{label:"Vue错误",value:"vueError"},{label:"异步错误",value:"promise"},{label:"资源错误",value:"resource"},{label:"网络请求",value:"request"},{label:"Xhr请求",value:"xhr"},{label:"性能监控",value:"performance"},{label:"点击行为监控",value:"click"},{label:"白屏监控",value:"whiteScreen"},{label:"错误录屏上报",value:"recordScreen",disabled:!0}],projectTypeOptions:[{value:1,label:"web"}]});const n=i(),a=l({id:0,name:"",desc:"",monitorAppId:"",projectType:1,delay:30,encryption:0,watch:["pageChange"],maxQueues:1,status:1,cookieUserKey:""}),d=l({monitorAppId:[{required:!0,message:"请输入应用ID",trigger:"blur"}],name:[{required:!0,message:"请输入应用名称",trigger:"blur"}],desc:[{required:!0,message:"请输入应用说明",trigger:"blur"}]}),p=u((()=>{const{monitorAppId:e="",encryption:t,maxQueues:o,delay:r,watch:n=[],cookieUserKey:l=""}=a;let i={};n.forEach((e=>{i[e]=!0,n.includes(e)||(i[e]=!1)})),i=JSON.stringify(i);let u='<script>;(function(w,d,s){n=()=>{const r=`http://msc-serve.missxiaolin.com`;new MonitorSdk({monitorAppId:`{monitorAppId}`,uuId:()=>MUtils.monitorCookie("{cookieUserField}"),watch:{monitorWatch},report:{url:`${r}/api/upload`,trackUrl:`${r}/api/tracker/upload`,encryption:{monitorEncryption},maxQueues:{monitorMaxQueues},reportType:{monitorReportType},delay: {monitorDelay}}}) /* 多环境适配放开这里 } */ };(()=>{const e=d.createElement("script");e.readyState?e.onreadystatechange=function(){"loaded"!==e.readyState&&"complete"!==e.readyState||(e.onreadystatechange=null,n())}:e.onload=function(){n()},e.src=s,d.head.append(e)})()})(window,document,"http://www.missxiaolin.com/monitorSdk.js");<\/script>';return u=u.replace(/\{monitorAppId\}/g,`${e}`),u=u.replace(/\{cookieUserField\}/g,`${l}`),u=u.replace(/\{monitorWatch\}/g,`${i}`),u=u.replace(/\{monitorEncryption\}/g,`${t}`),u=u.replace(/\{monitorMaxQueues\}/g,`${o}`),u=u.replace(/\{monitorReportType\}/g,"1"),u=u.replace(/\{monitorDelay\}/g,""+1e3*r),u})),f=()=>{e.isShowPorjectPop=!1,a.id=0,a.name="",a.desc="",a.monitorAppId="",a.projectType=1,a.delay=30,a.encryption=0,a.watch=["pageChange"],a.maxQueues=1,a.cookieUserKey=""},{paginationData:m,handleCurrentChange:y,handleSizeChange:b}=r((()=>{h()})),h=async()=>{let t={page:m.currentPage,pageSize:m.pageSize},r=await o(t);r.success&&(m.total=r.model.count,e.tableData=r.model.list)};return c((()=>{h()})),{data:e,paginationData:m,handleCurrentChange:y,handleSizeChange:b,handleClose:f,ruleFormRef:n,ruleForm:a,rules:d,submitForm:async e=>{e&&await e.validate((async(e,o)=>{if(e){let e=a,o=await t(e);o.success?(s({message:"保存成功",type:"success"}),f(),h(),F.getValidProject()):s({message:o.errorMessage,type:"error"})}}))},resetForm:e=>{e&&e.resetFields()},probeCode:p,probeCodeCopy:async()=>{try{await T(p.value)}catch(e){console.error(e)}},showHandleDetail:t=>{a.id=t.id,a.name=t.name,a.desc=t.desc,a.monitorAppId=t.monitorAppId,a.projectType=Number(t.projectType),a.delay=t.delay,a.encryption=t.encryption,a.watch=JSON.parse(t.watch),a.maxQueues=t.maxQueues,a.cookieUserKey=t.cookieUserKey,e.isShowPorjectPop=!0}}}},A={class:"app-container"},V={class:"flex"},P={class:"table-wrapper"},I={class:"pager-wrapper mt20"},U={class:"flex"},O={class:"copy-code-area"},D=(e=>(C("data-v-7f0d3370"),e=e(),k(),e))((()=>y("h4",null,"复制探针",-1))),L={class:"code"};const R=d(j,[["render",function(e,t,o,r,n,a){const l=p("el-button"),i=p("el-table-column"),u=p("el-table"),c=p("el-pagination"),s=p("el-card"),d=p("el-input"),C=p("el-form-item"),k=p("el-option"),_=p("el-select"),E=p("el-input-number"),T=p("el-radio"),F=p("el-radio-group"),j=p("el-checkbox"),R=p("el-checkbox-group"),z=p("el-form"),M=p("CopyDocument"),N=p("el-icon"),Q=p("el-dialog");return f(),m("div",A,[y("div",V,[b(l,{type:"primary",onClick:t[0]||(t[0]=e=>r.data.isShowPorjectPop=!0)},{default:h((()=>[g("新增应用")])),_:1})]),b(s,{class:"mt20"},{default:h((()=>[y("div",P,[b(u,{border:"",data:r.data.tableData},{default:h((()=>[b(i,{prop:"name",label:"应用名称",align:"center"}),b(i,{prop:"desc",label:"应用说明",align:"center"}),b(i,{prop:"monitorAppId",label:"项目Id",align:"monitorAppId"}),b(i,{prop:"delay",label:"上报间隔",align:"center"}),b(i,{label:"是否加密",align:"center"},{default:h((({row:e})=>[g(v(0==e.encryption?"不加密":"加密"),1)])),_:1}),b(i,{label:"是否开启",align:"center"},{default:h((({row:e})=>[g(v(0==e.status?"禁用":"开启"),1)])),_:1}),b(i,{prop:"updateTime",label:"修改时间",align:"center"}),b(i,{label:"操作",align:"center"},{default:h((({row:e})=>[b(l,{type:"text",onClick:t=>r.showHandleDetail(e)},{default:h((()=>[g(" 修改 ")])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"])]),y("div",I,[b(c,{background:"",layout:r.paginationData.layout,"page-sizes":r.paginationData.pageSizes,total:r.paginationData.total,"page-size":r.paginationData.pageSize,currentPage:r.paginationData.currentPage,onSizeChange:r.handleSizeChange,onCurrentChange:r.handleCurrentChange},null,8,["layout","page-sizes","total","page-size","currentPage","onSizeChange","onCurrentChange"])])])),_:1}),b(Q,{modelValue:r.data.isShowPorjectPop,"onUpdate:modelValue":t[13]||(t[13]=e=>r.data.isShowPorjectPop=e),title:"应用",width:"60%","before-close":r.handleClose},{default:h((()=>[y("div",U,[b(z,{ref:"ruleFormRef",model:r.ruleForm,rules:r.rules,"label-width":"120px",size:"default","status-icon":"",class:"pop-form"},{default:h((()=>[b(C,{label:"应用ID",prop:"monitorAppId"},{default:h((()=>[b(d,{modelValue:r.ruleForm.monitorAppId,"onUpdate:modelValue":t[1]||(t[1]=e=>r.ruleForm.monitorAppId=e),disabled:!!r.ruleForm.id},null,8,["modelValue","disabled"])])),_:1}),b(C,{label:"应用类型",prop:"projectType"},{default:h((()=>[b(_,{modelValue:r.ruleForm.projectType,"onUpdate:modelValue":t[2]||(t[2]=e=>r.ruleForm.projectType=e)},{default:h((()=>[(f(!0),m(w,null,S(r.data.projectTypeOptions,(e=>(f(),x(k,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),b(C,{label:"应用名称",prop:"name"},{default:h((()=>[b(d,{modelValue:r.ruleForm.name,"onUpdate:modelValue":t[3]||(t[3]=e=>r.ruleForm.name=e)},null,8,["modelValue"])])),_:1}),b(C,{label:"应用说明",prop:"desc"},{default:h((()=>[b(d,{modelValue:r.ruleForm.desc,"onUpdate:modelValue":t[4]||(t[4]=e=>r.ruleForm.desc=e)},null,8,["modelValue"])])),_:1}),b(C,{label:"上报条数",prop:"maxQueues"},{default:h((()=>[b(E,{modelValue:r.ruleForm.maxQueues,"onUpdate:modelValue":t[5]||(t[5]=e=>r.ruleForm.maxQueues=e),min:1,max:20},null,8,["modelValue"])])),_:1}),b(C,{label:"应用间隔",prop:"delay"},{default:h((()=>[b(d,{modelValue:r.ruleForm.delay,"onUpdate:modelValue":t[6]||(t[6]=e=>r.ruleForm.delay=e)},{append:h((()=>[g("ms")])),_:1},8,["modelValue"])])),_:1}),b(C,{label:"Cookie字段",prop:"cookieUserKey"},{default:h((()=>[b(d,{modelValue:r.ruleForm.cookieUserKey,"onUpdate:modelValue":t[7]||(t[7]=e=>r.ruleForm.cookieUserKey=e)},null,8,["modelValue"])])),_:1}),b(C,{label:"是否加密",prop:"encryption"},{default:h((()=>[b(F,{modelValue:r.ruleForm.encryption,"onUpdate:modelValue":t[8]||(t[8]=e=>r.ruleForm.encryption=e),disabled:!0},{default:h((()=>[b(T,{label:1},{default:h((()=>[g("加密")])),_:1}),b(T,{label:0},{default:h((()=>[g("不加密")])),_:1})])),_:1},8,["modelValue"])])),_:1}),b(C,{label:"是否使用",prop:"encryption"},{default:h((()=>[b(F,{modelValue:r.ruleForm.status,"onUpdate:modelValue":t[9]||(t[9]=e=>r.ruleForm.status=e)},{default:h((()=>[b(T,{label:1},{default:h((()=>[g("使用")])),_:1}),b(T,{label:0},{default:h((()=>[g("禁用")])),_:1})])),_:1},8,["modelValue"])])),_:1}),b(C,{label:"监听配置",prop:"watch"},{default:h((()=>[b(R,{modelValue:r.ruleForm.watch,"onUpdate:modelValue":t[10]||(t[10]=e=>r.ruleForm.watch=e)},{default:h((()=>[(f(!0),m(w,null,S(r.data.watchList,((e,t)=>(f(),x(j,{label:e.value,key:t,disabled:e.disabled||!1},{default:h((()=>[g(v(e.label),1)])),_:2},1032,["label","disabled"])))),128))])),_:1},8,["modelValue"])])),_:1}),b(C,null,{default:h((()=>[b(l,{type:"primary",onClick:t[11]||(t[11]=e=>r.submitForm(r.ruleFormRef))},{default:h((()=>[g(v(r.ruleForm.id&&0!=r.ruleForm.id?"修改":"添加"),1)])),_:1}),b(l,{onClick:t[12]||(t[12]=e=>r.resetForm(r.ruleFormRef))},{default:h((()=>[g("重置")])),_:1})])),_:1})])),_:1},8,["model","rules"]),y("div",O,[D,y("div",L,[b(N,{class:"copy-btn",size:"22",onClick:r.probeCodeCopy},{default:h((()=>[b(M)])),_:1},8,["onClick"]),g(" "+v(r.probeCode),1)])])])])),_:1},8,["modelValue","before-close"])])}],["__scopeId","data-v-7f0d3370"]]);export{R as default};
