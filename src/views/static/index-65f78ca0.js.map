{"version":3,"file":"index-65f78ca0.js","sources":["../../src/components/performanceComponents/perfEchart.vue","../../src/components/performanceComponents/wxPerfEchart.vue","../../src/api/performance/index.ts"],"sourcesContent":["<template>\n  <div class=\"flex flex-row justify-between\" style=\"width: 100%\">\n    <el-statistic title=\"白屏时间\" :value=\"options.fp.value || 0\">\n      <template #suffix>ms</template>\n    </el-statistic>\n    <el-statistic title=\"DOM完成加载\" :value=\"(options.nt && options.nt.domReady) ? options.nt.domReady : 0\">\n      <template #suffix>ms</template>\n    </el-statistic>\n    <el-statistic title=\"页面完全加载\" :value=\"(options.nt && options.nt.pageLoad) ? options.nt.pageLoad : 0\">\n      <template #suffix>ms</template>\n    </el-statistic>\n  </div>\n  <Echarts :options=\"navigationEchart\"></Echarts>\n</template>\n\n<script lang=\"ts\">\nimport Echarts from \"@/components/echarts/index.vue\";\nimport { computed } from \"vue\";\nexport default {\n  components: {\n    Echarts,\n  },\n  props: {\n    options: {\n      type: Object,\n      required: true,\n    },\n  },\n  name: \"perfEchart\",\n  setup(props) {\n    /**\n     * @description: 性能指标图\n     * @param {*} computed\n     * @return {*}\n     */\n    const navigationEchart = computed(() => {\n\n      const NT: any = props.options?.nt || {};\n      if (!NT || !Object.keys(NT).length) return {};\n      const axisData = [\n        \"pageLoad\",\n        \"domReady\",\n        \"resourceLoad\",\n        \"domParse\",\n        \"contentDownload\",\n        \"ttfb\",\n        \"ssl\",\n        \"initialConnection\",\n        \"dnsLookup\"\n      ];\n\n      const seriesData: any[] = [];\n      const yAxisLeftData: any[] = [\n        \"页面完全加载\",\n        \"DOM完成加载\",\n        \"资源加载耗时\",\n        \"DOM解析耗时\",\n        \"内容传输耗时\",\n        \"请求响应耗时\",\n        \"SSL安全连接耗时\",\n        \"TCP连接耗时\",\n        \"DNS查询耗时\"\n      ];\n      const yAxisRightData: any[] = [];\n      axisData.forEach((item, index) => {\n        const value = (NT[item] || 0).toFixed(2);\n        yAxisRightData.push(`${value}ms`);\n        const data: any = {\n          name: item,\n          type: \"bar\",\n          stack: \"Total\",\n          label: {\n            show: true,\n            position: \"right\",\n          },\n          data: [],\n        };\n        // 重置 性能节点数据\n        for (let i = 0, len = axisData.length; i < len; i++) {\n          if (index == i) {\n            data.data.push(value);\n          } else {\n            data.data.push(\"-\");\n          }\n        }\n        seriesData.push(data);\n      });\n      const {\n        pageLoad = 0,\n        domReady = 0,\n        resourceLoad = 0,\n        domParse = 0,\n        contentDownload = 0,\n        ttfb = 0,\n        ssl = 0,\n        initialConnection = 0,\n        dnsLookup = 0\n      }: any = NT;\n      const defaultSeriesData: any[] = [\n        `${pageLoad + domReady + resourceLoad + domParse + contentDownload + ttfb + ssl + initialConnection + dnsLookup}`,\n        `${domReady + resourceLoad + domParse + contentDownload + ttfb + ssl + initialConnection + dnsLookup}`,\n        `${resourceLoad + domParse + contentDownload + ttfb + ssl + initialConnection + dnsLookup}`,\n        `${domParse + contentDownload + ttfb + ssl + initialConnection + dnsLookup}`,\n        `${contentDownload + ttfb + ssl + initialConnection + dnsLookup}`,\n        `${ttfb + ssl + initialConnection + dnsLookup}`,\n        `${ssl + initialConnection + dnsLookup}`,\n        `${initialConnection + dnsLookup}`,\n        `${dnsLookup}`,\n      ];\n\n      const option = {\n        tooltip: {\n          trigger: \"axis\",\n          axisPointer: {\n            type: \"shadow\",\n          },\n          formatter: function (params: any) {\n            for (let i = 1, len = params.length; i < len; i++) {\n              let { name, value, seriesName, color } = params[i];\n              if (value !== \"-\") {\n                return `${name}</br><span style=\"display:flex; align-items: center;\">\n\t\t\t\t\t<i style=\"display:block;margin-right:5px;border-radius:50%;width:10px;height:10px;left:5px;background-color:${color}\"></i>${seriesName}:\n\t\t\t\t\t<i style=\"padding-left: 30px;\">${value}</i>\n\t\t\t\t</span>`;\n              }\n            }\n          },\n        },\n        xAxis: {\n          type: \"value\",\n          show: false,\n          axisLine: {\n            show: false,\n          },\n          axisTick: {\n            show: false,\n          },\n          splitLine: {\n            lineStyle: {\n              type: \"dotted\",\n            },\n          },\n        },\n        yAxis: [\n          {\n            axisLine: {\n              show: false,\n            },\n            axisTick: {\n              show: false,\n            },\n            splitLine: {\n              lineStyle: {\n                type: \"dotted\",\n              },\n            },\n            type: \"category\",\n            data: yAxisLeftData,\n          },\n          {\n            axisLine: {\n              show: false,\n            },\n            axisTick: {\n              show: false,\n            },\n            splitLine: {\n              lineStyle: {\n                type: \"dotted\",\n              },\n            },\n            type: \"category\",\n            data: yAxisRightData,\n          },\n        ],\n        seriesColorReset: false,\n        series: [\n          {\n            name: \"Placeholder\",\n            type: \"bar\",\n            stack: \"Total\",\n            silent: true,\n            itemStyle: {\n              borderColor: \"transparent\",\n              color: \"transparent\",\n            },\n            emphasis: {\n              itemStyle: {\n                borderColor: \"transparent\",\n                color: \"transparent\",\n              },\n            },\n            data: defaultSeriesData,\n          },\n          ...seriesData,\n        ],\n      };\n      // console.log(\"option---\", option);\n      return option;\n    });\n\n    return {\n      navigationEchart,\n    };\n  },\n};\n</script>\n","<template>\n  <div class=\"flex flex-row justify-between\" style=\"width: 100%\">\n    <!-- <el-statistic title=\"白屏时间\" :value=\"ntFormat('FP')\">\n      <template #suffix>ms</template>\n    </el-statistic>\n    <el-statistic title=\"DOM Ready\" :value=\"ntFormat('FCP')\">\n      <template #suffix>ms</template>\n    </el-statistic>\n    <el-statistic title=\"首次可交互时间\" :value=\"ntFormat('LCP')\">\n      <template #suffix>ms</template>\n    </el-statistic> -->\n  </div>\n  <Echarts :options=\"navigationEchart\"></Echarts>\n</template>\n\n<script lang=\"ts\">\nimport Echarts from \"@/components/echarts/index.vue\";\nimport { computed } from \"vue\";\nexport default {\n  components: {\n    Echarts,\n  },\n  props: {\n    options: {\n      type: Object,\n      required: true,\n    },\n  },\n  name: \"wxPerfEchart\",\n  setup(props) {\n    /**\n     * @description: 性能指标图\n     * @param {*} computed\n     * @return {*}\n     */\n    const navigationEchart = computed(() => {\n      console.log(props)\n      const NT: any = props.options?.nt || {};\n      console.log(NT)\n      if (!NT || !Object.keys(NT).length) return {};\n      const axisData = [\n        \"firstRenderduration\",\n        \"scriptduration\",\n        \"routeduration\",\n        \"appLaunchduration\",\n        \"loadPackageduration\",\n      ];\n\n      const seriesData: any[] = [];\n      const yAxisLeftData: any[] = [\n        \"页面渲染\",\n        \"JS注入\",\n        \"路由\",\n        \"小程序启动\",\n        \"代码包下载\",\n      ];\n      const yAxisRightData: any[] = [];\n      axisData.forEach((item, index) => {\n        const value = (NT[item] || 0).toFixed(2);\n        yAxisRightData.push(`${value}ms`);\n        const data: any = {\n          name: item,\n          type: \"bar\",\n          stack: \"Total\",\n          label: {\n            show: true,\n            position: \"right\",\n          },\n          data: [],\n        };\n        // 重置 性能节点数据\n        for (let i = 0, len = axisData.length; i < len; i++) {\n          if (index == i) {\n            data.data.push(value);\n          } else {\n            data.data.push(\"-\");\n          }\n        }\n        seriesData.push(data);\n      });\n      const {\n        // firstRender = 0,\n        scriptduration = 0,\n        routeduration = 0,\n        loadPackageduration = 0,\n        appLaunchduration = 0\n      }: any = NT;\n      // TODO 待优化\n      const defaultSeriesData: any[] = [\n        // `${appLaunch + loadPackage + route + script + firstRender}`,\n        `${appLaunchduration + loadPackageduration + routeduration + scriptduration}`,\n        `${appLaunchduration + loadPackageduration + routeduration}`,\n        `${appLaunchduration + loadPackageduration}`,\n        `${loadPackageduration}`,\n      ];\n\n      const option = {\n        tooltip: {\n          trigger: \"axis\",\n          axisPointer: {\n            type: \"shadow\",\n          },\n          formatter: function (params: any) {\n            for (let i = 1, len = params.length; i < len; i++) {\n              let { name, value, seriesName, color } = params[i];\n              if (value !== \"-\") {\n                return `${name}</br><span style=\"display:flex; align-items: center;\">\n\t\t\t\t\t<i style=\"display:block;margin-right:5px;border-radius:50%;width:10px;height:10px;left:5px;background-color:${color}\"></i>${seriesName}:\n\t\t\t\t\t<i style=\"padding-left: 30px;\">${value}</i>\n\t\t\t\t</span>`;\n              }\n            }\n          },\n        },\n        xAxis: {\n          type: \"value\",\n          show: false,\n          axisLine: {\n            show: false,\n          },\n          axisTick: {\n            show: false,\n          },\n          splitLine: {\n            lineStyle: {\n              type: \"dotted\",\n            },\n          },\n        },\n        yAxis: [\n          {\n            axisLine: {\n              show: false,\n            },\n            axisTick: {\n              show: false,\n            },\n            splitLine: {\n              lineStyle: {\n                type: \"dotted\",\n              },\n            },\n            type: \"category\",\n            data: yAxisLeftData,\n          },\n          {\n            axisLine: {\n              show: false,\n            },\n            axisTick: {\n              show: false,\n            },\n            splitLine: {\n              lineStyle: {\n                type: \"dotted\",\n              },\n            },\n            type: \"category\",\n            data: yAxisRightData,\n          },\n        ],\n        seriesColorReset: false,\n        series: [\n          {\n            name: \"Placeholder\",\n            type: \"bar\",\n            stack: \"Total\",\n            silent: true,\n            itemStyle: {\n              borderColor: \"transparent\",\n              color: \"transparent\",\n            },\n            emphasis: {\n              itemStyle: {\n                borderColor: \"transparent\",\n                color: \"transparent\",\n              },\n            },\n            data: defaultSeriesData,\n          },\n          ...seriesData,\n        ],\n      };\n      // console.log(\"option---\", option);\n      return option;\n    });\n\n    return {\n      navigationEchart,\n    };\n  },\n};\n</script>\n","import { request } from \"@/utils/service\";\nimport type * as Performance from \"./types/performance\";\n\n/**\n * 获取性能列表\n * @returns\n */\nexport function performanceList(data: Performance.PerformanceListRequestData) {\n  return request<Performance.PerformanceListResponseData>({\n    url: \"/adm/performance/list\",\n    method: \"post\",\n    data,\n  });\n}\n\n\n/**\n * 页面平均性能\n * @param data \n * @returns \n */\nexport function performanceEchartByUrl(data: Performance.PerformanceEchartByUrlRequestData) {\n  return request<Performance.PerformanceEchartByUrlResponseData>({\n    url: \"/adm/performance/echart/by/url\",\n    method: \"post\",\n    data,\n  });\n}"],"names":["_hoisted_1","class","components","Echarts","props","options","type","Object","required","name","setup","navigationEchart","computed","NT","_a","nt","keys","length","axisData","seriesData","yAxisRightData","forEach","item","index","value","toFixed","push","data","stack","label","show","position","i","len","pageLoad","domReady","resourceLoad","domParse","contentDownload","ttfb","ssl","initialConnection","dnsLookup","tooltip","trigger","axisPointer","formatter","params","seriesName","color","xAxis","axisLine","axisTick","splitLine","lineStyle","yAxis","seriesColorReset","series","silent","itemStyle","borderColor","emphasis","_openBlock","_createElementBlock","_Fragment","_createElementVNode","_createVNode","_component_el_statistic","title","$props","fp","_","_sfc_main","scriptduration","routeduration","loadPackageduration","appLaunchduration","performanceList","request","url","method","performanceEchartByUrl"],"mappings":"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"}