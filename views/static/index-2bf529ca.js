import{t as e}from"./index-f9346ce2.js";import{r as a}from"./service-708868eb.js";import{u as t}from"./usePagination-431f037d.js";import{g as l,i as n,R as r,Q as s,K as i,_ as o,r as u,o as d,a as p,k as c,l as g,b as f,F as h,A as m,y,z as _,d as D,e as C}from"./index-6c853ef9.js";const v={class:"app-container"},T={class:"custom-main-contents visit-left-contents",ref:"mainRef"},b={class:"flex-1 flex flex-column"},x={key:0},S={class:"pager-wrapper mt20"},R={class:"visit-right-contents"},k={class:"basic-header"},I={key:1,class:"flex flex-1 flex-row justify-center"};const E=o({setup(){let o=l({height:500,searchData:{uuId:"",categorys:["PAGE_CHANGE","USER_CLICK","HTTP_LOG","JS_ERROR"],data:e({format:["00:00:00","23:59:59"]})},categoryOptions:[{value:"PAGE_CHANGE",label:"用户浏览"},{value:"USER_CLICK",label:"用户点击"},{value:"HTTP_LOG",label:"用户请求"},{value:"JS_ERROR",label:"JS错误"}],pageDetail:{},userList:[]});const{paginationData:u,handleCurrentChange:d,handleSizeChange:p}=t((()=>{c()})),c=async()=>{if(!o.searchData.uuId||!o.searchData.categorys)return void i(o.searchData.uuId?"请选择事件类型":"请输入用户ID");let e={uuId:o.searchData.uuId,categorys:o.searchData.categorys,startTime:o.searchData.data[0],endTime:o.searchData.data[1],page:u.currentPage,pageSize:u.pageSize},t=await function(e){return a({url:"/adm/get/user/behavior",method:"post",data:e})}(e);t.success?(o.pageDetail=t.model.pageDetail||{},o.userList=t.model.userList||[],u.total=t.model.count):o.pageDetail={}},g=async()=>{u.currentPage=1,u.pageSize=10,c()},f=n(null);return r((()=>{s((()=>{o.height=f.value.offsetHeight-100})),g()})),{data:o,init:g,resetSearch:()=>{},paginationData:u,handleCurrentChange:d,handleSizeChange:p,mainRef:f}}},[["render",function(e,a,t,l,n,r){const s=u("el-input"),i=u("el-form-item"),o=u("el-option"),E=u("el-select"),L=u("el-date-picker"),P=u("el-button"),z=u("el-form"),G=u("el-card"),A=u("el-timeline-item"),H=u("el-timeline"),U=u("el-scrollbar"),O=u("el-pagination"),w=u("el-col"),V=u("el-row"),N=u("el-empty");return d(),p("div",v,[c(G,{class:"search-wrapper"},{default:g((()=>[c(z,{ref:"searchFormRef",inline:!0,model:l.data.searchData},{default:g((()=>[c(i,{prop:"uuId",label:"用户Id"},{default:g((()=>[c(s,{modelValue:l.data.searchData.uuId,"onUpdate:modelValue":a[0]||(a[0]=e=>l.data.searchData.uuId=e),placeholder:"请输入用户ID"},null,8,["modelValue"])])),_:1}),c(i,{prop:"categorys",label:"事件类型"},{default:g((()=>[c(E,{modelValue:l.data.searchData.categorys,"onUpdate:modelValue":a[1]||(a[1]=e=>l.data.searchData.categorys=e),multiple:"",placeholder:"请选择事件类型",style:{width:"400px"}},{default:g((()=>[(d(!0),p(h,null,m(l.data.categoryOptions,(e=>(d(),D(o,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),c(i,{prop:"phone",label:"日期"},{default:g((()=>[c(L,{modelValue:l.data.searchData.data,"onUpdate:modelValue":a[2]||(a[2]=e=>l.data.searchData.data=e),type:"datetimerange","range-separator":"-","start-placeholder":"开始时间","end-placeholder":"结束时间"},null,8,["modelValue"])])),_:1}),c(i,null,{default:g((()=>[c(P,{type:"primary",onClick:l.init},{default:g((()=>[y("查询")])),_:1},8,["onClick"]),c(P,{onClick:l.resetSearch},{default:g((()=>[y("重置")])),_:1},8,["onClick"])])),_:1})])),_:1},8,["model"])])),_:1}),f("section",T,[l.data.userList&&l.data.userList.length>0?(d(),p(h,{key:0},[c(G,{class:"flex flex-1 flex-column visit-left-list"},{default:g((()=>[f("div",b,[c(U,{"max-height":`${l.data.height}px`,style:{flex:"1"}},{default:g((()=>[c(H,null,{default:g((()=>[(d(!0),p(h,null,m(l.data.userList,((e,a)=>(d(),D(A,{icon:"USER_CLICK"==e.category?"Pointer":"HTTP_LOG"==e.category?"Position":"PAGE_CHANGE"==e.category?"Files":"JS_ERROR"==e.category?"CircleClose":"",center:"",timestamp:e.happenTime,placement:"top",key:a},{default:g((()=>[c(G,{style:{width:"95%"}},{default:g((()=>["USER_CLICK"==e.category?(d(),p(h,{key:0},[f("p",null,_(e.subType),1),f("p",null,"pageUrl: "+_(e.pageUrl),1),f("p",null,"tagName: "+_(e.tagName),1),f("p",null,"innerHTML: "+_(e.innerHTML),1)],64)):C("",!0),"HTTP_LOG"==e.category?(d(),p(h,{key:1},[f("p",null,_(e.subType)+"请求方式: "+_(e.method)+" 请求方式:"+_(e.type)+" 接口状态: "+_(e.status)+" 耗时:"+_(e.duration)+" ms ",1),f("p",null,"pageUrl: "+_(e.pageUrl),1),f("p",null,"pathName: "+_(e.pathName),1),f("p",null,"requestText: "+_(e.requestText),1),f("p",null,"responseText: "+_(e.responseText),1)],64)):C("",!0),"PAGE_CHANGE"==e.category?(d(),p(h,{key:2},[f("p",null,[y(_(e.subType)+" ",1),e.duration?(d(),p("span",x,"停留:"+_(e.duration)+"ms",1)):C("",!0)]),f("p",null,"referrer: "+_(e.referrer),1),f("p",null,"from: "+_(e.from),1),f("p",null,"to: "+_(e.to),1)],64)):C("",!0),"JS_ERROR"==e.category?(d(),p(h,{key:3},[f("p",null,_(e.subType),1),f("p",null,_(e.errorMsg),1)],64)):C("",!0)])),_:2},1024)])),_:2},1032,["icon","timestamp"])))),128))])),_:1})])),_:1},8,["max-height"]),f("div",S,[c(O,{background:"",layout:l.paginationData.layout,"page-sizes":l.paginationData.pageSizes,total:l.paginationData.total,"page-size":l.paginationData.pageSize,currentPage:l.paginationData.currentPage,onSizeChange:l.handleSizeChange,onCurrentChange:l.handleCurrentChange},null,8,["layout","page-sizes","total","page-size","currentPage","onSizeChange","onCurrentChange"])])])])),_:1}),f("div",R,[f("div",k,[c(V,null,{default:g((()=>[c(w,{span:12},{default:g((()=>[y("cip： "+_(l.data.pageDetail.ip),1)])),_:1}),c(w,{span:12},{default:g((()=>[y("cregion： "+_(l.data.pageDetail.country),1)])),_:1}),c(w,{span:12},{default:g((()=>[y("deviceType： "+_(l.data.pageDetail.deviceType),1)])),_:1}),c(w,{span:12},{default:g((()=>[y("os： "+_(l.data.pageDetail.os),1)])),_:1}),c(w,{span:12},{default:g((()=>[y("browserInfo： "+_(l.data.pageDetail.browserInfo),1)])),_:1}),c(w,{span:12},{default:g((()=>[y("device： "+_(l.data.pageDetail.device),1)])),_:1}),c(w,{span:12},{default:g((()=>[y("deviceModel： "+_(l.data.pageDetail.deviceModel),1)])),_:1}),c(w,{span:12},{default:g((()=>[y("language： "+_(l.data.pageDetail.language),1)])),_:1}),c(w,{span:12},{default:g((()=>[y("netWork： "+_(l.data.pageDetail.netWork),1)])),_:1}),c(w,{span:12}),c(w,{span:12},{default:g((()=>[y("userAgent： "+_(l.data.pageDetail.userAgent),1)])),_:1})])),_:1})])])],64)):(d(),p("div",I,[c(N,{description:"未找到该用户记录"})]))],512)])}],["__scopeId","data-v-9ac4d4fe"]]);export{E as default};
//# sourceMappingURL=index-2bf529ca.js.map
