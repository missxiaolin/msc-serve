import{t as a,n as e}from"./index-f9346ce2.js";import{M as t,p as l,c as s,a as r,b as n}from"./index-01b26f48.js";import{u as i}from"./usePagination-431f037d.js";import{J as o,a as c}from"./jsHoursEchart-4f3ec5f8.js";import{r as d}from"./service-708868eb.js";import{P as u,W as p,a as m}from"./index-85234cb2.js";import{E as h,l as f}from"./index-ecc82270.js";import{g,i as v,c as b,R as D,_ as P,r as C,o as _,a as y,k as E,l as x,b as j,y as U,z as T,F as w,A as k,d as z,e as S,n as V,M as J,N as F}from"./index-6c853ef9.js";import"./validate-f5786776.js";const I={components:{MapEcharts:t,pageHoursEchart:l,JsHoursEchart:o,PerfEchart:u,WxPerfEchart:p,Echarts:h},setup(){let t=g({activePage:"",pvCount:0,visitList:[],ipcregion:[],jsErrorTableData:[],perfEchartOPtion:[],project:{},EchartDatas:[],tableData:[]});const l=v({simpleUrl:"",data:a({format:["00:00:00","23:59:59"]})}),{paginationData:o,handleCurrentChange:u,handleSizeChange:p}=i((()=>{h()}),{layout:"total, prev, pager, next, jumper"}),h=async()=>{let a={simpleUrl:l.value.simpleUrl,startTime:l.value.data[0],endTime:l.value.data[1],page:o.currentPage,pageSize:o.pageSize},e=await s(a);e.success&&(t.pvCount=e.model.pvCount,o.total=e.model.count,t.visitList=e.model.list,P(t.visitList[0]||{}))},P=a=>{const{simpleUrl:e=""}=a;t.activePage=e,(async()=>{const a={startTime:l.value.data[0],endTime:l.value.data[1],simpleUrl:t.activePage};let e=await n(a);if(!e.success)return!1;t.ipcregion=e.model})(),(async()=>{let a={startTime:l.value.data[0],endTime:l.value.data[1],simpleUrl:t.activePage},e=await c(a);e.success&&(t.jsErrorTableData=e.model)})(),y(),E(),x()},C=b((()=>({startTime:l.value.data[0],endTime:l.value.data[1],simpleUrl:t.activePage}))),_=b((()=>({data:l.value.data,simpleUrl:t.activePage}))),y=async()=>{let a={startTime:l.value.data[0],endTime:l.value.data[1],simpleUrl:t.activePage},e=await m(a);e.success&&(t.perfEchartOPtion=e.model,t.project=e.model.project)},E=async()=>{let a={startTime:l.value.data[0],endTime:l.value.data[1],simpleUrl:t.activePage},e=await r(a);e.success&&(t.EchartDatas=e.model)},x=async()=>{let a={startTime:l.value.data[0],endTime:l.value.data[1],simpleUrl:t.activePage},e=await function(a){return d({url:"/adm/api/agregate/list",method:"post",data:a})}(a);e.success&&(t.tableData=e.model)},j={toolbox:{show:!0,feature:{mark:{show:!0},dataView:{show:!0,readOnly:!1},restore:{show:!0},saveAsImage:{show:!0}}},series:[{name:"Nightingale Chart",type:"pie",radius:[20,100],center:["50%","50%"],roseType:"area",itemStyle:{borderRadius:8},data:[]}]},U=b((()=>(a,e=t.EchartDatas)=>{var l;let s=f.cloneDeep(j);const r=e[a];let n=[];return null==(l=r.axisData)||l.forEach(((a,e)=>{n.push({name:a,value:r.seriesData[e]})})),s.series[0].data=n,s})),T=async()=>{h()};return D((()=>{T()})),{data:t,searchData:l,resetSearch:async()=>{l.value={simpleUrl:"",data:a({format:["00:00:00","23:59:59"]})}},init:T,paginationData:o,handleCurrentChange:u,handleSizeChange:p,visitPercent:a=>(a/t.pvCount*100).toFixed(2)+"%",numberFormat:e,handleVisitItem:P,hourPvUvParam:C,hourJsParam:_,echartData:U}}},A=a=>(J("data-v-ce32ce18"),a=a(),F(),a),H={class:"app-container"},M={class:"custom-main-contents visit-left-contents"},O={class:"card-header"},L=A((()=>j("span",null,"访问页面",-1))),R={class:"flex-1 flex flex-column"},N=["onClick"],W={class:"flex align-items-center"},B={class:"pager-wrapper mt20"},q={class:"visit-right-contents flex-1 flex flex-column"},G=A((()=>j("div",{class:"card-header"},[j("span",null,"健康概览")],-1))),K=A((()=>j("div",{class:"card-header"},[j("span",null,"JS错误聚类")],-1))),Q=A((()=>j("div",{class:"card-header"},[j("span",null,"API详情")],-1))),X={class:"flex-1 flex flex-column"},Y=A((()=>j("div",{class:"card-header"},[j("span",null,"地理分布")],-1))),Z=A((()=>j("div",{class:"card-header"},[j("span",null,"终端分布")],-1)));const $=P(I,[["render",function(a,e,t,l,s,r){const n=C("el-input"),i=C("el-form-item"),o=C("el-date-picker"),c=C("el-button"),d=C("el-form"),u=C("el-card"),p=C("ArrowRightBold"),m=C("el-icon"),h=C("el-scrollbar"),f=C("el-pagination"),g=C("pageHoursEchart"),v=C("el-tab-pane"),b=C("JsHoursEchart"),D=C("PerfEchart"),P=C("WxPerfEchart"),J=C("el-tabs"),F=C("el-table-column"),I=C("el-table"),A=C("MapEcharts"),$=C("Echarts");return _(),y("div",H,[E(u,{class:"search-wrapper"},{default:x((()=>[E(d,{ref:"searchFormRef",inline:!0,model:l.searchData},{default:x((()=>[E(i,{prop:"simpleUrl",label:"页面链接"},{default:x((()=>[E(n,{modelValue:l.searchData.simpleUrl,"onUpdate:modelValue":e[0]||(e[0]=a=>l.searchData.simpleUrl=a),placeholder:"请输入带*的页面链接"},null,8,["modelValue"])])),_:1}),E(i,{prop:"phone",label:"日期"},{default:x((()=>[E(o,{modelValue:l.searchData.data,"onUpdate:modelValue":e[1]||(e[1]=a=>l.searchData.data=a),type:"datetimerange","range-separator":"-","start-placeholder":"开始时间","end-placeholder":"结束时间"},null,8,["modelValue"])])),_:1}),E(i,null,{default:x((()=>[E(c,{type:"primary",onClick:l.init},{default:x((()=>[U("查询")])),_:1},8,["onClick"]),E(c,{onClick:l.resetSearch},{default:x((()=>[U("重置")])),_:1},8,["onClick"])])),_:1})])),_:1},8,["model"])])),_:1}),j("section",M,[E(u,{class:"flex flex-1 flex-column visit-left-list"},{header:x((()=>[j("div",O,[L,j("span",null,"总PV: "+T(l.data.pvCount)+"次",1)])])),default:x((()=>[j("div",R,[E(h,null,{default:x((()=>[(_(!0),y(w,null,k(l.data.visitList,((a,e)=>(_(),y("dl",{class:V(["arco-list-item",{active:l.data.activePage==a.simpleUrl}]),key:e,onClick:e=>l.handleVisitItem(a)},[j("dt",null,T(a.simpleUrl),1),j("dd",W,[U(T(l.numberFormat(a.pageCount))+"次("+T(l.visitPercent(a.pageCount))+") ",1),E(m,null,{default:x((()=>[E(p)])),_:1})])],10,N)))),128))])),_:1}),j("div",B,[E(f,{background:"",layout:l.paginationData.layout,"page-sizes":l.paginationData.pageSizes,total:l.paginationData.total,"page-size":l.paginationData.pageSize,currentPage:l.paginationData.currentPage,onSizeChange:l.handleSizeChange,onCurrentChange:l.handleCurrentChange},null,8,["layout","page-sizes","total","page-size","currentPage","onSizeChange","onCurrentChange"])])])])),_:1}),j("div",q,[E(h,null,{default:x((()=>[E(u,null,{header:x((()=>[G])),default:x((()=>[E(J,{class:"demo-tabs"},{default:x((()=>[E(v,{label:"pv/uv"},{default:x((()=>[E(g,{params:l.hourPvUvParam},null,8,["params"])])),_:1}),E(v,{label:"JS报错"},{default:x((()=>[E(b,{params:l.hourJsParam},null,8,["params"])])),_:1}),1==l.data.project.projectType?(_(),z(v,{key:0,label:"平均性能"},{default:x((()=>[E(D,{options:l.data.perfEchartOPtion},null,8,["options"])])),_:1})):S("",!0),2==l.data.project.projectType?(_(),z(v,{key:1,label:"平均性能"},{default:x((()=>[E(P,{options:l.data.perfEchartOPtion},null,8,["options"])])),_:1})):S("",!0)])),_:1})])),_:1}),E(u,{class:"mt20"},{header:x((()=>[K])),default:x((()=>[E(I,{data:l.data.jsErrorTableData,border:"",style:{width:"100%"}},{default:x((()=>[E(F,{prop:"errorMsg",label:"错误内容"}),E(F,{prop:"count",label:"错误数"}),E(F,{prop:"userCount",label:"影响用户数"})])),_:1},8,["data"])])),_:1}),E(u,{class:"mt20"},{header:x((()=>[Q])),default:x((()=>[j("div",X,[E(I,{border:"",data:l.data.tableData},{default:x((()=>[E(F,{prop:"pathName",label:"API名称",align:"left"}),E(F,{prop:"method",label:"请求方式",align:"center"}),E(F,{prop:"count",label:"请求次数",align:"center"}),E(F,{prop:"avgDuration",label:"平均耗时（ms）",align:"center"}),E(F,{prop:"avgDuration",label:"请求成功率",align:"center"},{default:x((({row:a})=>[U(T(100*(a.successCount/a.count).toFixed(2))+"% ",1)])),_:1})])),_:1},8,["data"])])])),_:1}),E(u,{class:"mt20"},{header:x((()=>[Y])),default:x((()=>[E(A,{ipCregion:l.data.ipcregion},null,8,["ipCregion"])])),_:1}),E(u,{class:"mt20"},{header:x((()=>[Z])),default:x((()=>[E(J,{class:"demo-tabs"},{default:x((()=>[l.data.EchartDatas.os?(_(),z(v,{key:0,label:"系统版本"},{default:x((()=>[E($,{options:l.echartData("os")},null,8,["options"])])),_:1})):S("",!0),l.data.EchartDatas.device?(_(),z(v,{key:1,label:"浏览设备"},{default:x((()=>[E($,{options:l.echartData("device")},null,8,["options"])])),_:1})):S("",!0),l.data.EchartDatas.browser?(_(),z(v,{key:2,label:"浏览器版本"},{default:x((()=>[E($,{options:l.echartData("browser")},null,8,["options"])])),_:1})):S("",!0),l.data.EchartDatas.screen?(_(),z(v,{key:3,label:"设备分辨率"},{default:x((()=>[E($,{options:l.echartData("screen")},null,8,["options"])])),_:1})):S("",!0)])),_:1})])),_:1})])),_:1})])])])}],["__scopeId","data-v-ce32ce18"]]);export{$ as default};
//# sourceMappingURL=list-f29bfa07.js.map
